var SAVING_ROWDATA_SEPERATOR="_ROTAREPES_ATADWOR_GNIVAS_";var SAVING_COLDATA_SEPERATOR="_ROTAREPES_ATADLOC_GNIVAS_";var SAVING_NAMEVALUE_SEPERATOR="_ROTAREPES_EULAVEMAN_GNIVAS_";var COL_NONDISPLAY_PERMISSION_PREX="[NOISSIMREP_YALPSIDNON]";var ReportFamily={LIST:"list",DETAIL:"detail",EDITABLELIST:"editablelist",EDITABLELIST2:"editablelist2",LISTFORM:"listform",EDITABLEDETAIL2:"editabledetail2",EDITABLEDETAIL:"editabledetail",FORM:"form"};var ART_DIALOG_OBJ=null;var EventTools=new Object;EventTools.addEventHandler=function(d,f,e){if(d.addEventListener){d.addEventListener(f,e,false)}else{if(d.attachEvent){d.attachEvent("on"+f,e)}else{d["on"+f]=e}}};EventTools.removeEventHandler=function(d,f,e){if(d.removeEventListener){d.removeEventListener(f,e,false)}else{if(d.detachEvent){d.detachEvent("on"+f,e)}else{d["on"+f]=null}}};EventTools.formatEvent=function(c){if(typeof c.charCode=="undefined"){c.charCode=(c.type=="keypress")?c.keyCode:0;c.isChar=(c.charCode>0)}if(c.srcElement&&!c.target){c.eventPhase=2;var d=getDocumentScroll();c.pageX=c.clientX+d.scrollLeft-document.body.clientLeft;c.pageY=c.clientY+d.scrollTop-document.body.clientTop;if(!c.preventDefault){c.preventDefault=function(){this.returnValue=false}}if(c.type=="mouseout"){c.relatedTarget=c.toElement}else{if(c.type=="mouseover"){c.relatedTarget=c.fromElement}}if(!c.stopPropagation){c.stopPropagation=function(){this.cancelBubble=true}}if(typeof c.button==" undefined "){c.button=c.which}c.target=c.srcElement;c.time=(new Date).getTime()}return c};EventTools.getEvent=function(){if(window.event){return this.formatEvent(window.event)}else{return EventTools.getEvent.caller.arguments[0]}};function checkExp(c,d){return d.match(c)}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};function isWXNumber(b){if(b==null||b==""){return false}if(!checkExp(/^[+-]?\d+(\.\d+)?$/g,b)){return false}return true}String.prototype.getBytesLength=function(){return this.replace(/[^\x00-\xff]/gi,"--").length};var XMLHttpREPORT={_objPool:[],_getInstance:function(){for(var b=0;b<this._objPool.length;b++){if(this._objPool[b].readyState==0||this._objPool[b].readyState==4){return this._objPool[b]}}this._objPool[this._objPool.length]=this._createObj();return this._objPool[this._objPool.length-1]},_createObj:function(){if(window.XMLHttpRequest){var b=new XMLHttpRequest()}else{var b=new ActiveXObject("Microsoft.XMLHTTP")}if(b.readyState==null){b.readyState=0;b.addEventListener("load",function(){b.readyState=4;if(typeof b.onreadystatechange=="function"){b.onreadystatechange()}},false)}return b},sendReq:function(a,b,c,d,f,g){var h=this._createObj();with(h){try{if(b.indexOf("?")>0){b+="&randnum="+Math.random()}else{b+="?randnum="+Math.random()}open(a,b,true);setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");send(c);onreadystatechange=function(){if(h.readyState==4){if(h.status==200||h.status==304){if(d!=null){d(h,g)}}else{if(f!=null){f(h,g)}}}}}catch(e){alert(e)}finally{}}}};function sendAsynRequestToServer(j,g,k,h){if(j==null||j==""){return}var i=j.split("?");if(i==null||i.length<=1){i[1]=""}else{if(i.length>=2){if(i.length>2){for(var l=2;l<i.length;l=l+1){i[1]=i[1]+"?"+i[l]}}}}XMLHttpREPORT.sendReq("POST",i[0],i[1],g,k,h)}function getDocumentSize(){if(document.compatMode=="BackCompat"&&document.body){return{width:document.body.clientWidth,height:document.body.clientHeight}}else{return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}}function getDocumentScroll(){var h=0,e=0,f=0,g=0;if(document.compatMode=="BackCompat"&&document.body||isChrome){h=document.body.scrollTop;e=document.body.scrollLeft;f=document.body.scrollWidth;g=document.body.scrollHeight}else{if(document.documentElement){h=document.documentElement.scrollTop;e=document.documentElement.scrollLeft;f=document.documentElement.scrollWidth;g=document.documentElement.scrollHeight}}return{scrollTop:h,scrollLeft:e,scrollWidth:f,scrollHeight:g}}function getAllParentScrollOffsetValue(e){var f=0;var d=0;e=e.offsetParent;while(e!=null){if(e.scrollLeft){f+=e.scrollLeft}if(e.scrollTop){d+=e.scrollTop}e=e.parentNode}return{scrollWidth:f,scrollHeight:d}}function getElementAbsolutePosition(m){if(!m){return null}var n=m;var h=n.offsetHeight;var j=n.offsetWidth;var k=0;var l=0;while(n!=null){k+=n.offsetLeft;if(n.className=="cls-fixed-headerInner"&&isIE){if(n.style.right!=null&&n.style.right!=""){k=k-parseInt(n.style.right)}}l+=n.offsetTop;n=n.offsetParent}var i=getAllParentScrollOffsetValue(m);if(i){k=k-i.scrollWidth;l=l-i.scrollHeight}i=getDocumentScroll();if(i){k=k+i.scrollLeft;l=l+i.scrollTop}return{top:l,left:k,width:j,height:h}}function removeSubStr(j,k,l,m){if(j==null||j==""||k==null||k==""||l==null||l==""){return j}if(m==null){m=""}var h=j.indexOf(k);while(h>=0){var n=j.substring(0,h);j=j.substring(h+k.length);h=j.indexOf(l);if(h<0){j=n;break}var i=j.substring(h+l.length);if(i==""){j=n;break}j=n+m+i;h=j.indexOf(k)}return j}function getSubStrValue(h,i,j){if(h==null||h==""||i==null||i==""||j==null||j==""){return""}var f=h.indexOf(i);if(f<0){return""}var g=h.substring(f+i.length);f=g.indexOf(j);if(f>=0){g=g.substring(0,f)}return g}function isPositiveInteger(c){if(c==null||c==""){return false}var d="^[1-9][0-9]*$";return c.match(d)}function paramdecode(b){if(b==null||b==""){return b}b=b.replace(/wx_QUOTE_wx/g,"'");b=b.replace(/wx_DBLQUOTE_wx/g,'"');b=b.replace(/wx_DOLLAR_wx/g,"$");return b}function jsonParamEncode(e,f){if(e==null||e==""){return e}var d=null;if(!f){d=new RegExp("'","g");e=e.replace(d,"wx_json_QUOTE_wx");d=new RegExp('"',"g");e=e.replace(d,"wx_json_DBLQUOTE_wx")}d=new RegExp("\n","g");e=e.replace(d,"wx_json_NEWLINE_wx");return e}function jsonParamDecode(d){if(d==null||d==""){return d}var c=new RegExp("wx_json_QUOTE_wx","g");d=d.replace(c,"'");c=new RegExp("wx_json_DBLQUOTE_wx","g");d=d.replace(c,'"');c=new RegExp("wx_json_NEWLINE_wx","g");d=d.replace(c,"\n");return d}function isEmptyMap(d){if(d==null){return true}for(var c in d){return false}return true}function getElementBgColor(d){var e=d.style.backgroundColor;if(e!=null&&e!=""){return e}if(document.defaultView&&document.defaultView.getComputedStyle){var f=document.defaultView.getComputedStyle(d,null);if(f){e=f.backgroundColor}}else{if(d.currentStyle){e=d.currentStyle.backgroundColor}}if(e!=null&&e!=""){return e}return d.bgColor}function getParentElementObj(f,d){if(!f||!d){return null}var e=f.parentNode;if(!e){return null}if(e.tagName==d){return e}else{return getParentElementObj(e,d)}}function isElementOrChildElement(d,f){while(d!=null){try{if(d.getAttribute("id")==f){return true}}catch(e){break}d=d.parentNode}return false}function getWXInputBoxChildNode(h){var j=h.childNodes;if(!j||j.length==0){return null}for(var f=0,g=j.length;f<g;f++){if(j.item(f).nodeType!=1){continue}if(isWXInputBoxNode(j.item(f))){return j.item(f)}var i=getWXInputBoxChildNode(j.item(f));if(i!=null){return i}}return null}function isWXInputBoxNode(d){if(d==null||d.nodeType!=1){return false}var f=d.getAttribute("id");var e=d.getAttribute("typename");if(f!=null&&f.indexOf("_guid_")>0&&e!=null&&e!=""){return true}return false}function getInputBoxChildNode(g){var h=g.childNodes;if(!h||h.length==0){return null}for(var e=0,f=h.length;e<f;e++){if(h.item(e).nodeType!=1){continue}return h.item(e)}return null}function getComponentMetadataObj(f){if(f==null||f==""){return null}var e=document.getElementById(f+"_metadata");if(e==null){return null}var d=new Object();d.pageid=e.getAttribute("pageid");d.componentid=e.getAttribute("componentid");d.componentguid=f;d.refreshComponentGuid=e.getAttribute("refreshComponentGuid");d.componentTypeName=e.getAttribute("componentTypeName");d.metaDataSpanObj=e;return d}function getReportMetadataObj(e){if(e==null||e==""){return null}var f=getComponentMetadataObj(e);if(f==null){return null}f.reportid=f.componentid;f.reportguid=e;f.reportfamily=f.metaDataSpanObj.getAttribute("reportfamily");var d=f.metaDataSpanObj.getAttribute("isSlaveReport");if(d=="true"){f.slave_reportid=f.reportid}else{f.slave_reportid=null}return f}function getComponentUrl(h,k,i){var g=document.getElementById(h+"_url_id");var j=g.getAttribute("value");if(i!=null&&i!=""){j=document.getElementById(getComponentGuidById(h,i)+"_url_id").getAttribute("value")}if(!j||j==""){wx_warn("获取组件URL失败，没有取到其原始url");return null}j=paramdecode(j);var l=g.getAttribute("ancestorPageUrls");if(l!=null&&l!=""){j=replaceUrlParamValue(j,"ancestorPageUrls",l)}if(k!=null&&k!=""){j=replaceUrlParamValue(j,"refreshComponentGuid",k)}if(i!=null&&i!=""){j=replaceUrlParamValue(j,"SLAVE_REPORTID",i)}return j}function resetComponentUrl(v,p,w,r){if(w==null||w==""){return w}var n=document;var i=getComponentGuidById(v,p);var u=getComponentMetadataObj(i);if(u==null){return w}if(u.componentTypeName=="application.report"){var o=getReportMetadataObj(i);if(r==null||r==""||r.indexOf("navigate")>=0){w=removeReportNavigateInfosFromUrl(w,o,null)}if(r==null||r==""||r.indexOf("searchbox")>=0){w=removeReportConditionBoxValuesFromUrl(w,o)}}else{if(u.componentTypeName=="container.tabspanel"){w=replaceUrlParamValue(w,p+"_selectedIndex",null)}}var t=u.metaDataSpanObj.getAttribute("childComponentIds");if(t!=null&&t!=""){var x=t.split(";");for(var s=0,q=x.length;s<q;s++){if(x[s]==null||x[s]==""){continue}w=resetComponentUrl(v,x[s],w)}}return w}function getInputboxParentElementObj(j,i){if(j==null||i==null||i==""){return null}var g=j.parentNode;if(g==null){return null}if(g.tagName!=i){return getInputboxParentElementObj(g,i)}if(i=="FONT"){var f=g.getAttribute("id");if(f==null||f.indexOf("font_")<0||f.indexOf("_guid_")<0){return getInputboxParentElementObj(g,i)}}else{if(i=="TD"){var h=g.getAttribute("id");if(h==null||h.indexOf("_td")<0||h.indexOf("_guid_")<0){return getInputboxParentElementObj(g,i)}}}return g}function getColConditionValueByParentElementObj(p){if(p==null){return null}var m=null;if(p.tagName=="FONT"){var n=p.getAttribute("id");if(n==null||n.indexOf("font_")<0){return null}m=n.substring("font_".length);if(m.lastIndexOf("_conditions")==m.length-"_conditions".length){var j=getWXInputBoxChildNode(p);if(j==null){return p.getAttribute("value")}return getInputBoxValue(j.getAttribute("id"),j.getAttribute("typename"))}}else{var k=p.getAttribute("id");if(k==null||k==""){return null}m=getReportGuidByInputboxId(k)}if(m==null||m==""){return null}var o=getReportMetadataObj(m);var i=getUpdateColSrcObj(p,o.reportguid,o.reportfamily,null);if(i!=null){var j=getWXInputBoxChildNode(i);if(j==null){return p.getAttribute("value")}return getInputBoxValue(j.getAttribute("id"),j.getAttribute("typename"))}else{var j=getWXInputBoxChildNode(p);if(j==null){return p.getAttribute("value")}var l=getUpdateColDestObj(p,o.reportguid,o.reportfamily,null);if(l!=null){return getInputBoxLabel(j.getAttribute("id"),j.getAttribute("typename"))}else{return getInputBoxValue(j.getAttribute("id"),j.getAttribute("typename"))}}}function getUpdateColDestObj(k,q,o,i){var r=k.getAttribute("updatecolDest");if(r==null||r==""){return i}var p=null;if(o==ReportFamily.EDITABLELIST2||o==ReportFamily.LISTFORM){var l=k.parentNode;p=l.getElementsByTagName("TD")}else{if(o==ReportFamily.EDITABLEDETAIL2){var m=getParentElementObj(k,"TABLE");p=m.getElementsByTagName("TD")}else{if(o==ReportFamily.EDITABLEDETAIL||o==ReportFamily.FORM){p=document.getElementsByName("font_"+q)}}}if(p==null){return i}for(var n=0;n<p.length;n++){if(p[n].getAttribute("value_name")==r){return p[n]}}return i}function getUpdateColSrcObj(l,r,p,i){var k=l.getAttribute("updatecolSrc");if(k==null||k==""){return i}var q=null;if(p==ReportFamily.EDITABLELIST2||p==ReportFamily.LISTFORM){var m=l.parentNode;q=m.getElementsByTagName("TD")}else{if(p==ReportFamily.EDITABLEDETAIL2){var n=getParentElementObj(l,"TABLE");q=n.getElementsByTagName("TD")}else{if(p==ReportFamily.EDITABLEDETAIL||p==ReportFamily.FORM){q=document.getElementsByName("font_"+r)}}}if(q==null){return i}for(var o=0;o<q.length;o++){if(q[o].getAttribute("value_name")==k){return q[o]}}return i}function getObjectByJsonString(a){if(a==null||a==""){return null}a=paramdecode(a);a=jsonParamEncode(a,true);var b=eval("("+a+")");return b}function getComponentGuidById(d,c){if(c==null||c==""||c==d){return d}return d+WX_GUID_SEPERATOR+c}function getComponentIdByGuid(c){if(c==null||c==""){return null}var d=c.lastIndexOf(WX_GUID_SEPERATOR);if(d>0){return c.substring(d+WX_GUID_SEPERATOR.length)}return c}function getPageIdByComponentGuid(c){if(c==null||c==""){return null}var d=c.lastIndexOf(WX_GUID_SEPERATOR);if(d>0){return c.substring(0,d)}return c}function getReportGuidByInputboxId(g){var e=g.indexOf(WX_GUID_SEPERATOR);var f=g.substring(0,e);var h=g.substring(e+WX_GUID_SEPERATOR.length);e=h.indexOf("_");h=h.substring(0,e);return reportguid=f+WX_GUID_SEPERATOR+h}function postlinkurl(t,o){if(t==null||t==""){return}var l=document;var n=l.createElement("Form");n.method="post";t=paramdecode(t);var s=splitUrlAndParams(t,true);var r=s[0];var k=s[1];if(k!=null){var m;for(var q in k){if(q==null||q==""){continue}m=k[q];if(m==null){m=""}var p=l.createElement("input");p.setAttribute("name",q);p.setAttribute("value",m);p.setAttribute("type","hidden");n.appendChild(p)}}n.action=r;l.body.appendChild(n);n.submit();l.body.removeChild(n)}function replaceUrlParamValue(f,e,d){if(f==null||f==""){return f}if(e==null||e==""){return f}f=removeSubStr(f,"?"+e+"=","&","?");f=removeSubStr(f,"&"+e+"=","&","&");if(d!=null){if(f.indexOf("?")>0){f=f+"&"}else{f=f+"?"}f=f+e+"="+d}return f}function getParamValueFromUrl(f,e){if(f==null||f==""){return""}if(e==null||e==""){return""}var d=getSubStrValue(f,"?"+e+"=","&");if(d==""){d=getSubStrValue(f,"&"+e+"=","&")}return d}function splitUrlAndParams(x,o){if(x==null||x==""){return null}var n=new Array();var p=x.indexOf("?");if(p==0){return null}if(p<0){n[0]=x;n[1]=null;return n}var i=x.substring(p+1);x=x.substring(0,p);if(i==""){n[0]=x;n[1]=null;return n}var t=new Object();var v=i.split("&");var w,r,q;for(var u=0,s=v.length;u<s;u=u+1){w=v[u];if(w==null||w==""){continue}p=w.indexOf("=");if(p==0){continue}if(p>0){r=w.substring(0,p);q=w.substring(p+1);if(o){q=decodeURIComponent(q)}}else{r=w;q=""}t[r]=q}n[0]=x;n[1]=t;return n}function wx_ltrim(f,d){if(f==null||f==""){return f}if(d==null||d==""){d=" "}var e=f.indexOf(d);while(e==0){f=f.substring(d.length);e=f.indexOf(d)}return f}function wx_rtrim(f,d){if(f==null||f==""){return f}if(d==null||d==""){d=" "}var e=f.lastIndexOf(d);while(e>=0&&e==f.length-d.length){f=f.substring(0,f.length-d.length);e=f.lastIndexOf(d)}return f}function wx_trim(c,d){c=wx_ltrim(c,d);c=wx_rtrim(c,d);return c}function isArray(b){return Object.prototype.toString.call(b)=="[object Array]"}function convertToArray(c){if(c==null){return null}if(isArray(c)){return c}var d=new Array();d[d.length]=c;return d}function splitTextValues(j,l,i){var m=j.search(l);if(m<0){return null}var h=j.substring(m,m+i);var k="";if(m>0){k=j.substring(0,m)}var n=j.substring(m+i);return{start:k,mid:h,end:n}}function parseStringToArray(i,l,h){if(i==null||i==""||l==null){return null}if(l==""){return i}var j=new Array();var k=i.split(l);for(var g=0;g<k.length;g++){if(k[g]==null||k[g]==""){continue}if(h===false&&wx_trim(k[g])==""){continue}j[j.length]=k[g]}return j}var WX_UTIL_LOADED=true;