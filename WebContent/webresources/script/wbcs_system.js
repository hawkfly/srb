var WX_GUID_SEPERATOR="_guid_";var ISOPERA=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);var isChrome=(navigator.userAgent.indexOf("Chrome")!==-1);var isIE=(navigator.userAgent.toLowerCase().indexOf("msie")!=-1);var WX_UPDATE_ALLDATA;var WX_IS_SAVE;var WX_showProcessingBar=true;var WX_serverUrl;function refreshComponent(d,c){WX_serverUrl=paramdecode(d);WX_serverUrl=replaceUrlParamValue(WX_serverUrl,"WX_ISAJAXLOAD","true");if(!isHasIgnoreReportsSavingData(WX_serverUrl,c)){loadPage("ok")}else{loadPage("ok")}}function loadPage(n){WX_IS_SAVE=false;if(!wx_isOkConfirm(n)){return false}var i=WX_serverUrl;var o=new Object();o.serverUrl=i;var j=getParamValueFromUrl(i,"PAGEID");if(j==""){wx_warn("在URL中没有取到PAGEID，无法加载");return}o.pageid=j;var l=getParamValueFromUrl(i,"refreshComponentGuid");if(l==null||l==""){l=j}else{if(l.indexOf("[OUTERPAGE]")==0){i=replaceUrlParamValue(i,"refreshComponentGuid",null);i=replaceUrlParamValue(i,"WX_ISOUTERPAGE","true")}}o.refreshComponentGuid=l;var k=getParamValueFromUrl(i,"SLAVE_REPORTID");o.slave_reportid=k;var m=i.split("?");if(m==null||m.length<=1){m[1]=""}else{if(m.length>2){for(var p=2;p<m.length;p=p+1){m[1]=m[1]+"?"+m[p]}}}XMLHttpREPORT.sendReq("POST",m[0],m[1],callBack,onErrorMethod,o);if(WX_showProcessingBar){displayLoadingMessage()}WX_showProcessingBar=true;closeAllColFilterResultSpan()}var responseStateCode={NONREFRESHPAGE:0,FAILED:-1,SUCCESS:1};var callback_jsonResultsObj=null;function callBack(r,F){hideLoadingMessage();WX_showProcessingBar=true;var x=r.responseText;var D=F.pageid;var C=F.serverUrl;var u=F.refreshComponentGuid;var y=x.indexOf("<RESULTS_INFO-"+D+">");var z=x.indexOf("</RESULTS_INFO-"+D+">");var v=null;if(y>=0&&z>=0&&z>y){v=x.substring(y+("<RESULTS_INFO-"+D+">").length,z);x=x.substring(0,y)+x.substring(z+("</RESULTS_INFO-"+D+">").length)}callback_jsonResultsObj=getObjectByJsonString(v);if(callback_jsonResultsObj==null){wx_error("更新页面数据失败");return}var s=null;if(u.indexOf("[DYNAMIC]")==0){u=callback_jsonResultsObj.dynamicRefreshComponentGuid;s=callback_jsonResultsObj.dynamicSlaveReportId}else{s=F.slave_reportid}if(s!=null&&s!=""){u=getComponentGuidById(D,s)}var A=u;if(A.indexOf("[OUTERPAGE]")==0){A=A.substring("[OUTERPAGE]".length);u=D}if(callback_jsonResultsObj.errormess!=null&&callback_jsonResultsObj.errormess!=""){wx_error(callback_jsonResultsObj.errormess);return}if(callback_jsonResultsObj.statecode==responseStateCode.FAILED){if(callback_jsonResultsObj.warnmess!=null&&callback_jsonResultsObj.warnmess!=""){wx_warn(callback_jsonResultsObj.warnmess)}return}if(callback_jsonResultsObj.statecode!=responseStateCode.NONREFRESHPAGE){var q=document.getElementById("WX_CONTENT_"+A);if(q==null){wx_error("更新页面失败");return}if(A!=u){if(q.outerHTML!=null&&q.outerHTML!=undefined){q.outerHTML=x}else{q.innerHTML=x}}else{var B='<span id="WX_CONTENT_'+u+'">';var w="</span>";var t=x.indexOf(B);if(t>=0){x=x.substring(t+B.length);t=x.lastIndexOf(w);if(t>0){x=x.substring(0,t)}}q.innerHTML=x}if(s==null||s==""){var E=document.getElementById(D+"_url_id");E.setAttribute("value",callback_jsonResultsObj.pageurl);if(callback_jsonResultsObj.pageEncodeUrl!=null&&callback_jsonResultsObj.pageEncodeUrl!=""){E.setAttribute("encodevalue",callback_jsonResultsObj.pageEncodeUrl)}}}callback_warn()}function callback_warn(){if(callback_jsonResultsObj.warnmess==null||callback_jsonResultsObj.warnmess==""){callback_alert()}else{if(WXConfig.prompt_dialog_type=="ymprompt"){wx_warn(callback_jsonResultsObj.warnmess,{handler:callback_alert})}else{wx_warn(callback_jsonResultsObj.warnmess,null,null,null,null);callback_alert()}}}function callback_alert(){if(callback_jsonResultsObj.alertmess==null||callback_jsonResultsObj.alertmess==""){callback_success()}else{if(WXConfig.prompt_dialog_type=="ymprompt"){wx_alert(callback_jsonResultsObj.alertmess,{handler:callback_success})}else{wx_alert(callback_jsonResultsObj.alertmess,null,null,null,null);callback_success()}}}function callback_success(){if(callback_jsonResultsObj.successmess==null||callback_jsonResultsObj.successmess==""){doPostCallback()}else{if(WXConfig.prompt_dialog_type=="ymprompt"){wx_success(callback_jsonResultsObj.successmess,{handler:doPostCallback})}else{wx_success(callback_jsonResultsObj.successmess,null,null,null,null);doPostCallback()}}}function doPostCallback(){var h=callback_jsonResultsObj.updateReportGuids;if(h!=null&&h!=""){var i;for(var f=0;f<h.length;f=f+1){i=h[f].value;if(WX_selectedTrObjs&&WX_selectedTrObjs[i]){delete WX_selectedTrObjs[i]}if(WX_startTrIdxMap&&WX_startTrIdxMap[i]){delete WX_startTrIdxMap[i]}if(WX_Current_Slave_TrObj&&WX_Current_Slave_TrObj[i]){delete WX_Current_Slave_TrObj[i]}if(WX_UPDATE_ALLDATA&&WX_UPDATE_ALLDATA[i]){delete WX_UPDATE_ALLDATA[i]}}}var j=callback_jsonResultsObj.onloadMethods;if(j&&j!=""){var g;for(var f=0;f<j.length;f=f+1){g=j[f];if(!g||!g.methodname){continue}if(g.methodparams){g.methodname(g.methodparams)}else{g.methodname()}}}if(h!=null&&h!=""){for(var f=0;f<h.length;f=f+1){i=h[f].value;if(WX_ALL_SAVEING_DATA&&WX_ALL_SAVEING_DATA[i]){delete WX_ALL_SAVEING_DATA[i]}}}}function onErrorMethod(c,d){hideLoadingMessage();if(WXConfig.load_error_message!=null&&WXConfig.load_error_message!=""){wx_error(WXConfig.load_error_message)}}function isHasIgnoreReportsSavingData(z,p){if(WX_UPDATE_ALLDATA==null||isEmptyMap(WX_UPDATE_ALLDATA)){return false}var A=getParamValueFromUrl(z,"PAGEID");var u=getParamValueFromUrl(z,"refreshComponentGuid");var q=getParamValueFromUrl(z,"SLAVE_REPORTID");var x=getParamValueFromUrl(z,"WX_ISREFRESH_BY_MASTER");if(x==="true"){return false}var B=new Array();var i=new Object();if(q!=null&&q!=""){i[q]="true"}else{if(u.indexOf("[DYNAMIC]")==0){var v=u.substring("[DYNAMIC]".length);var w=v.split(";");for(var y=0;y<w.length;y++){if(w[y]==null||w[y]==""){continue}var r=getComponentMetadataObj(getComponentGuidById(A,w[y]));if(r!=null){if(r.refreshComponentGuid==null||r.refreshComponentGuid==""){B[B.length]=getComponentGuidById(A,w[y])}else{B[B.length]=r.refreshComponentGuid}}}}else{if(u==null||u==""||u.indexOf("[OUTERPAGE]")==0){B[B.length]=A}}B[B.length]=u;getAllRefreshReportids(A,B,i)}if(p==null){p=new Object()}var s=new Array();for(var t in i){if(p[t]=="true"){continue}s[s.length]=getComponentGuidById(A,t)}if(s.length==0){return false}for(var y=0;y<s.length;y++){if(WX_UPDATE_ALLDATA[s[y]]!=null&&WX_UPDATE_ALLDATA[s[y]]!=""){return true}}return false}function getAllRefreshReportids(w,z,i){if(z==null||z.length==0){return}var x;for(var s=0;s<z.length;s++){x=z[s];var v=getComponentMetadataObj(x);if(v==null){continue}if(v.componentTypeName=="application.report"){i[v.componentid]="true";var j=v.metaDataSpanObj.getAttribute("dependingChildReportIds");if(j!=null&&j!=""){var q=j.split(";");for(var t=0;t<q.length;t++){if(q[t]==null||q[t]==""){continue}i[q[t]]="true";getAllInheritDependingChildReportIds(w,q[t],i)}}}else{var u=v.metaDataSpanObj.getAttribute("childComponentIds");if(u!=null&&u!=""){var y=u.split(";");for(var s=0,r=y.length;s<r;s++){if(y[s]==null||y[s]==""){continue}var p=new Array();p[p.length]=getComponentGuidById(w,y[s]);getAllRefreshReportids(w,p,i)}}}}}function isHasIgnoreSlaveReportsSavingData(i){if(WX_UPDATE_ALLDATA==null||isEmptyMap(WX_UPDATE_ALLDATA)){return false}var g=getPageIdByComponentGuid(i);var k=getComponentIdByGuid(i);var h=new Object();getAllInheritDependingChildReportIds(g,k,h);var l;for(var j in h){l=getComponentGuidById(g,j);if(WX_UPDATE_ALLDATA[l]!=null&&WX_UPDATE_ALLDATA[l]!=""){return true}}return false}function getAllInheritDependingChildReportIds(j,p,k){var i=getComponentGuidById(j,p);var m=getReportMetadataObj(i);if(m==null){return}var l=m.metaDataSpanObj.getAttribute("dependingChildReportIds");if(l==null||l==""){return}var n=l.split(";");for(var o=0;o<n.length;o++){if(n[o]==null||n[o]==""){continue}k[n[o]]="true";getAllInheritDependingChildReportIds(j,n[o],k)}}function hasEditDataForSavingRow(m){if(m==null){return false}var n=m.getAttribute("id");if(n==null||n.indexOf("_tr_")<0){return false}var r=m.getElementsByTagName("TD");if(r==null||r.length==0){return false}var k=m.getAttribute("EDIT_TYPE");if(k&&k=="add"){var i;var q;var l;for(var p=0,o=r.length;p<o;p=p+1){i=r[p];q=i.getAttribute("value_name");if(q==null||q==""){continue}l=getColConditionValueByParentElementObj(i);if(l!=null&&l!=""){return true}}return false}else{return isChangedForThisEditRow(r)}}function isChangedForThisEditRow(l){if(l==null||l.length==0){return false}var g;var h;var j;var i;for(var k=0;k<l.length;k=k+1){g=l[k];h=g.getAttribute("value_name");if(h==null||h==""){continue}j=getColConditionValueByParentElementObj(g);i=g.getAttribute("oldvalue");if(j==null){j=""}if(i==null){i=""}if(j!=i){return true}}return false}function searchReportData(K,L,i){var N=getComponentGuidById(K,L);var G=getReportMetadataObj(N);var F=G.metaDataSpanObj.getAttribute("validateSearchMethod");if(F!=null&&F!=""){var M=getObjectByJsonString(F);var J=M.method(G);if(!J){return}}var Q=getComponentUrl(K,G.refreshComponentGuid,G.slave_reportid);if(Q==null){return}var R=document.getElementsByName("font_"+N+"_conditions");if(R!=null){var T=null;var O=null;var I=null;var y=null;for(var E=0,D=R.length;E<D;E=E+1){T=R[E];I=T.getAttribute("value_name");if(I==null||I==""){continue}y=T.getAttribute("iteratorindex");if(y!=null&&y!=""&&parseInt(y,10)>=0){I=I+"_"+parseInt(y,10)}O=getColConditionValueByParentElementObj(T);if(O==null||O==""){O=null}else{O=encodeURIComponent(O)}Q=replaceUrlParamValue(Q,I,O);var B=T.getAttribute("innerlogicid");if(B!=null&&B!=""){Q=replaceUrlParamValue(Q,B,getConditionSelectedValue(B,T.getAttribute("innerlogicinputboxtype")))}var A=T.getAttribute("columnid");if(A!=null&&A!=""){Q=replaceUrlParamValue(Q,A,getConditionSelectedValue(A,T.getAttribute("columninputboxtype")))}var P=T.getAttribute("valueid");if(P!=null&&P!=""){Q=replaceUrlParamValue(Q,P,getConditionSelectedValue(P,T.getAttribute("valueinputboxtype")))}}}Q=removeReportNavigateInfosFromUrl(Q,G,null);Q=removeLazyLoadParamsFromUrl(Q,G,true);var C=G.metaDataSpanObj.getAttribute("current_accessmode");if(C===WX_ACCESSMODE_ADD){Q=replaceUrlParamValue(Q,L+"_ACCESSMODE",null)}Q=replaceUrlParamValue(Q,"SEARCHREPORT_ID",G.reportid);if(i!=null){for(var z in i){if(z==null){continue}Q=replaceUrlParamValue(Q,z,i[z])}}var H=G.metaDataSpanObj.getAttribute("beforeSearchMethod");if(H!=null&&H!=""){var S=getObjectByJsonString(H);Q=S.method(K,L,Q);if(Q==null||Q==""){return}}refreshComponent(Q)}function removeReportConditionBoxValuesFromUrl(w,p){var q=document.getElementsByName("font_"+p.reportguid+"_conditions");if(q==null||q.length==0){return w}var s=null;var r=null;var i=null;var o=null;for(var u=0,t=q.length;u<t;u=u+1){s=q[u];i=s.getAttribute("value_name");if(i==null||i==""){continue}o=s.getAttribute("iteratorindex");if(o!=null&&o!=""&&parseInt(o,10)>=0){i=i+"_"+parseInt(o,10)}w=replaceUrlParamValue(w,i,null);var v=s.getAttribute("innerlogicid");if(v!=null&&v!=""){w=replaceUrlParamValue(w,v,null)}var n=s.getAttribute("columnid");if(n!=null&&n!=""){w=replaceUrlParamValue(w,n,null)}var x=s.getAttribute("valueid");if(x!=null&&x!=""){w=replaceUrlParamValue(w,x,null)}}return w}function getConditionSelectedValue(i,h){if(h=="radiobox"){var j=document.getElementsByName(i);if(j!=null){for(var f=0;f<j.length;f++){if(j[f].checked){return j[f].value}}}}else{var g=document.getElementById(i);if(g!=null){return g.options[g.options.selectedIndex].value}}return null}function setConditionInputBoxValue(s,n){if(n==null||isEmptyMap(n)){return false}var l=document.getElementsByName("font_"+s+"_conditions");if(l==null){return false}var i=null;var q=null;var o=null;for(var r=0,p=l.length;r<p;r=r+1){o=l[r];i=o.getAttribute("value_name");if(i==null||i==""){continue}q=n[i];if(q==null){continue}var t=o.getAttribute("customized_inputbox");if(t=="true"){o.setAttribute("value",q)}else{var m=getWXInputBoxChildNode(o);if(m==null){continue}setInputBoxValue(m.getAttribute("id"),m.getAttribute("typename"),q)}}}function navigateReportPage(v,p,z){var o=getReportMetadataObj(getComponentGuidById(v,p));var x=o.metaDataSpanObj.getAttribute("navigate_reportid");var w=getComponentUrl(v,o.refreshComponentGuid,o.slave_reportid);w=replaceUrlParamValue(w,x+"_PAGENO",z);var i=o.metaDataSpanObj.getAttribute("dependingChildReportIds");var s=o.metaDataSpanObj.getAttribute("reportfamily");if(i!=null&&i!=""&&(s==null||s.indexOf("list")<0)){var t=i.split(";");var y;for(var r=0,q=t.length;r<q;r=r+1){y=t[r];if(y==null||y==""){continue}var u=getReportMetadataObj(getComponentGuidById(v,y));if(u==null){continue}w=removeReportNavigateInfosFromUrl(w,u,null)}}refreshComponent(w)}function removeReportNavigateInfosFromUrl(x,i,v){if(v!=2){var y=i.metaDataSpanObj.getAttribute("navigate_reportid");if(y!=null&&y!=""){x=replaceUrlParamValue(x,y+"_PAGENO",null);x=replaceUrlParamValue(x,y+"_PAGECOUNT",null);x=replaceUrlParamValue(x,y+"_RECORDCOUNT",null)}}if(v!=1){var r=i.metaDataSpanObj.getAttribute("relateConditionReportNavigateIds");if(r!=null&&r!=""){var q=r.split(";");var o;for(var s=0;s<q.length;s=s+1){o=q[s];if(o==null||o==""){continue}x=replaceUrlParamValue(x,o+"_PAGENO",null);x=replaceUrlParamValue(x,o+"_PAGECOUNT",null);x=replaceUrlParamValue(x,o+"_RECORDCOUNT",null)}}var p=i.metaDataSpanObj.getAttribute("dependingChildReportIds");var t=i.metaDataSpanObj.getAttribute("reportfamily");if(p!=null&&p!=""&&(t==null||t.indexOf("list")<0)){var u=p.split(";");var z;for(var s=0;s<u.length;s=s+1){z=u[s];if(z==null||z==""){continue}var w=getReportMetadataObj(getComponentGuidById(i.pageid,z));if(w==null){continue}x=removeReportNavigateInfosFromUrl(x,w,v)}}}return x}var WX_SCROLL_DELAYTIME=50;function showComponentScroll(e,f,d){if(f!=null&&isWXNumber(f)){f=f+"px"}if(typeof(fleXenv)=="undefined"){wx_error("框架没有为此页面导入/webresources/scroll/scroll.js文件，请在＜page/＞的js属性中显式导入");return false}if(d==11){setTimeout(function(){showComponentVerticalScroll("vscroll_"+e,f)},WX_SCROLL_DELAYTIME)}else{if(d==12){setTimeout(function(){showComponentHorizontalScroll("hscroll_"+e)},WX_SCROLL_DELAYTIME)}else{if(d==13){showComponentVerticalScroll("vscroll_"+e,f);showComponentHorizontalScroll("hscroll_"+e)}else{if(d==21){setTimeout(function(){showComponentVerticalScroll("scroll_"+e,f)},WX_SCROLL_DELAYTIME)}else{if(d==22){setTimeout(function(){showComponentHorizontalScroll("scroll_"+e)},WX_SCROLL_DELAYTIME)}else{if(d==23){setTimeout(function(){showComponentAllScroll("scroll_"+e,f)},WX_SCROLL_DELAYTIME)}}}}}}}function showComponentVerticalScroll(e,d){if(!d||parseInt(d)<=0){return false}var f=document.getElementById(e);if(!f){return false}if(f.scrollHeight>parseInt(d)){f.style.height=d;fleXenv.fleXcrollMain(f);document.getElementById(e+"_hscrollerbase").className="hscrollerbase_hidden";f.fleXcroll.updateScrollBars()}else{f.style.height=f.scrollHeight+"px"}}function showComponentHorizontalScroll(d){var c=document.getElementById(d);if(!c){return false}c.style.height=(c.scrollHeight+15)+"px";fleXenv.fleXcrollMain(c);document.getElementById(d+"_vscrollerbase").className="vscrollerbase_hidden";c.fleXcroll.updateScrollBars()}function showComponentAllScroll(e,d){if(!d||parseInt(d)<=0){return false}var f=document.getElementById(e);if(!f){return false}if(f.scrollHeight>parseInt(d)){f.style.height=d}else{f.style.height=(f.scrollHeight+15)+"px"}fleXenv.fleXcrollMain(f);f.fleXcroll.updateScrollBars()}function createJsValidateTipObj(e){var f={owner:e,myContainer:null};var d=document.createElement("span");d.className="spanJsValidateErrorTip";document.body.appendChild(d);f.myContainer=d;f.show=function(b){if(!this.myContainer){return}this.myContainer.innerHTML=b;var h=this.owner;if(!h){return}var a=getElementAbsolutePosition(h);this.myContainer.style.display="block";this.myContainer.style.position="absolute";this.myContainer.style.left=a.left+"px";var c=e.getAttribute("id");if(c&&c=="WX_TEXTAREA_BOX"){this.myContainer.style.top=a.top+"px"}else{this.myContainer.style.top=(a.top+a.height)+"px"}this.myContainer.setAttribute("WX_NOT_HIDE","true");if(WX_tip_Obj){WX_tip_Obj.innerHTML="";WX_tip_Obj.style.display="none";WX_tip_Obj=null;document.body.onclick=null}WX_tip_Obj=this.myContainer;WX_bol_tip_show=true;document.body.onclick=checkErrorTipClick};f.hide=function(){if(!this.myContainer){return}this.myContainer.innerHTML="";this.myContainer.style.display="none"};return f}var WX_tip_Obj;var WX_bol_tip_show=false;function checkErrorTipClick(d){var e=d?d.target:event.srcElement;var f=e.getAttribute("WX_NOT_HIDE");if((!f||f!="true")&&!WX_bol_tip_show){WX_tip_Obj.innerHTML="";WX_tip_Obj.style.display="none";WX_tip_Obj=null;document.body.onclick=null}WX_bol_tip_show=false}var WX_startTrIdxMap;function initRowSelect(){if(WX_selectedTrObjs==null){WX_selectedTrObjs=new Object()}if(WX_startTrIdxMap==null){WX_startTrIdxMap=new Object()}}var WX_selectedTrObj_temp;var WX_shouldInvokeOnloadMethod_temp;function doSelectReportDataRowImpl(n){if(!wx_isOkConfirm(n)){return}var o=WX_selectedTrObj_temp;var l=WX_shouldInvokeOnloadMethod_temp;WX_selectedTrObj_temp=null;WX_shouldInvokeOnloadMethod_temp=null;if(o==null){return}var p=o.getAttribute("id");if(p==null||p==""){return}var s=p.substring(0,p.lastIndexOf("_tr_"));if(s==""){return}var m=getRowSelectType(s);if(m!="checkbox"&&m!="radiobox"&&m!="single"&&m!="multiply"){return}if(m=="checkbox"||m=="radiobox"){var r=null;if(m=="checkbox"){r=getSelectCheckBoxObj(o)}else{r=getSelectRadioBoxObj(o)}if(r==null){return}r.checked=true;var q="false";if(l==true){q="true"}doSelectedDataRowChkRadio(r,q,true)}else{if(!isListReportDataTrObj(o)){return}initRowSelect();var t=null;if(m=="single"){t=deselectAllDataRow(s)}selectDataRow(o,true);if(l==true){var k=new Array();k[0]=o;t=getRealDeselectedTrObjs(k,t);invokeRowSelectedMethods(getPageIdByComponentGuid(s),getComponentIdByGuid(s),k,t)}}}function doDeselectReportDataRowImpl(l){if(!wx_isOkConfirm(l)){return}var m=WX_selectedTrObj_temp;var j=WX_shouldInvokeOnloadMethod_temp;WX_selectedTrObj_temp=null;WX_shouldInvokeOnloadMethod_temp=null;if(m==null||!isSelectedRow(m)){return}var n=m.getAttribute("id");if(n==null||n==""){return}var q=n.substring(0,n.lastIndexOf("_tr_"));if(q==""){return}var k=getRowSelectType(q);if(k!="checkbox"&&k!="radiobox"&&k!="single"&&k!="multiply"){return}if(k=="checkbox"){var p=getSelectCheckBoxObj(m);if(p==null){return}p.checked=false;var o="false";if(j==true){o="true"}doSelectedDataRowChkRadio(p,o,true)}else{deselectDataRow(m);if(k=="radiobox"){var p=getSelectRadioBoxObj(m);if(p!=null){p.checked=false}}if(j==true){var r=new Array();r[0]=m;invokeRowSelectedMethods(getPageIdByComponentGuid(q),getComponentIdByGuid(q),null,r)}}}var WX_selected_shiftKey_temp;var WX_selected_ctrlKey_temp;var WX_selected_selecttype_temp;function doSelectDataRowEvent(i,m){var k=i||window.event;var n=k.srcElement||k.target;var l=getSelectedTrParent(n);if(l==null){return}var j=l.getAttribute("id");var h=j.substring(0,j.lastIndexOf("_tr_"));if(h==""){return}WX_selected_shiftKey_temp=k.shiftKey;WX_selected_ctrlKey_temp=k.ctrlKey;WX_selectedTrObj_temp=l;WX_selected_selecttype_temp=m;if(isHasIgnoreSlaveReportsSavingData(h)){wx_confirm("本操作可能会丢失对从报表数据的修改，是否继续？",null,null,null,doSelectDataRowEventImpl)}else{doSelectDataRowEventImpl("ok")}}function doSelectDataRowEventImpl(v){if(!wx_isOkConfirm(v)){return}var A=WX_selectedTrObj_temp;WX_selectedTrObj_temp=null;var w=A.getAttribute("id");var C=w.substring(0,w.lastIndexOf("_tr_"));if(C==""){return}initRowSelect();var E=w.substring(w.lastIndexOf("_")+1);var r=new Array();var D=new Array();if(WX_selected_selecttype_temp=="single"||(!WX_selected_ctrlKey_temp&&!WX_selected_shiftKey_temp)){D=deselectAllDataRow(C);selectDataRow(A,true);r[r.length]=A}else{var i=WX_selectedTrObjs[C];if(i!=null){if(WX_selected_shiftKey_temp){var s=WX_startTrIdxMap[C];D=deselectAllDataRow(C);WX_startTrIdxMap[C]=s;if(s!=null){var B=parseInt(s,10);var t=parseInt(E,10);var F=C+"_tr_";i=new Object();WX_selectedTrObjs[C]=i;var z=B;var u=document;while(true){var y=u.getElementById(F+z);if(y!=null){selectDataRow(y,false);r[r.length]=y}if(t==B){break}else{if(t>B){z=z+1;if(z>t){break}}else{z=z-1;if(z<t){break}}}}}else{selectDataRow(A,true);r[r.length]=A}}else{var x=i[w];if(x!=null){deselectDataRow(A);D[D.length]=A}else{selectDataRow(A,true);r[r.length]=A}}}else{selectDataRow(A,true);r[r.length]=A}}D=getRealDeselectedTrObjs(r,D);invokeRowSelectedMethods(getPageIdByComponentGuid(C),getComponentIdByGuid(C),r,D)}var WX_selected_selectBoxObj_temp;function doSelectedDataRowChkRadio(i,o,l){var m=i.type;var k=i.checked;if(m!="radio"&&m!="RADIO"&&m!="checkbox"&&m!="CHECKBOX"){return}var p=i.getAttribute("name");var j=p.lastIndexOf("_rowselectbox_col");if(j<=0){return}var n=p.substring(0,j);if(n==null||n==""){return}WX_selected_selectBoxObj_temp=i;WX_shouldInvokeOnloadMethod_temp=o;if(l!==true&&isHasIgnoreSlaveReportsSavingData(n)){wx_confirm("本操作可能会丢失对从报表数据的修改，是否继续？",null,null,null,doSelectedDataRowChkRadioImpl,cancelSelectDeselectChkRadio)}else{doSelectedDataRowChkRadioImpl("ok")}}function cancelSelectDeselectChkRadio(){if(WX_selected_selectBoxObj_temp==null){return}if(WX_selected_selectBoxObj_temp.checked){WX_selected_selectBoxObj_temp.checked=false}else{WX_selected_selectBoxObj_temp.checked=true}WX_selected_selectBoxObj_temp=null}function doSelectedDataRowChkRadioImpl(E){if(!wx_isOkConfirm(E)){wx_callCancelEvent();return}var F=WX_selected_selectBoxObj_temp;var y=WX_shouldInvokeOnloadMethod_temp;WX_selected_selectBoxObj_temp=null;WX_shouldInvokeOnloadMethod_temp=null;var I=F.type;var L=F.checked;initRowSelect();var R;var C=new Array();var P=new Array();var z=F.getAttribute("name");var D=z.lastIndexOf("_rowselectbox_col");if(D<=0){return}var N=z.substring(0,D);if(N==null||N==""){return}var G;var x;var O=F.getAttribute("rowgroup");if(O=="true"){var Q=getTreeGroupRowObj(N,F);if(Q==null){return}selectChildDataRows(Q,C,P,L);R=getParentElementObj(Q,"TABLE");var B=Q.getAttribute("id");var D=B.lastIndexOf("trgroup_");G=B.substring(0,D);x=Q.getAttribute("parenttridsuffix")}else{var K=getSelectedTrParent(F);if(K==null){return}var w=K.getAttribute("id");if(I=="radio"||I=="RADIO"){P=deselectAllDataRow(N);selectDataRow(K,false);C[C.length]=K}else{if(L){selectDataRow(K,false);C[C.length]=K}else{deselectDataRow(K);P[P.length]=K}var D=w.lastIndexOf("tr_");G=w.substring(0,D);x=K.getAttribute("parenttridsuffix")}R=getSelectedTableParent(K)}if(I=="checkbox"||I=="CHECKBOX"){var z=F.getAttribute("name");var D=z.lastIndexOf("_col");if(D<=0){return}var J=z.substring(0,D);var A=document.getElementsByName(J);var M=null;if(A&&A.length>0){M=A[0]}if(M){var H=WX_selectedTrObjs[N];if(H==null||isEmptyMap(H)){M.checked=false}else{M.checked=true}}if(x!=null&&x!=""){selectParentDataRows(G,x,L)}}if(!y||y!="false"){P=getRealDeselectedTrObjs(C,P);invokeRowSelectedMethods(getPageIdByComponentGuid(N),getComponentIdByGuid(N),C,P)}}function getTreeGroupRowObj(h,g){var e=g.parentNode;while(e!=null){if(e.tagName=="TR"){var f=e.getAttribute("id");if(f!=null&&f.indexOf(h)>=0&&f.indexOf("_trgroup_")>0){break}}e=e.parentNode}return e}function selectChildDataRows(D,i,E,C){var A=D.getAttribute("id");var t=A.lastIndexOf("trgroup_");var H=A.substring(0,t);var s=D.getAttribute("childdataidsuffixes");if(s&&s!=""){var u=s.split(";");for(var B=0,z=u.length;B<z;B=B+1){var F=u[B];if(!F||F==""){continue}var w=document.getElementById(H+F);if(!w){continue}var v=getSelectCheckBoxObj(w);var G=v.checked;if(C){v.checked=true;selectDataRow(w,false);if(!G){i[i.length]=w}}else{v.checked=false;deselectDataRow(w);if(G){E[E.length]=w}}}}var x=D.getAttribute("childgroupidsuffixes");if(x!=null&&x!=""){var y=x.split(";");for(var B=0;B<y.length;B=B+1){var F=y[B];if(!F||F==""){continue}var w=document.getElementById(H+F);if(!w){continue}var v=getSelectCheckBoxObj(w);if(C){v.checked=true}else{v.checked=false}}}}function selectParentDataRows(z,u,x){if(!u||u==""){return}var w=document.getElementById(z+u);if(!w){return}var i=getSelectCheckBoxObj(w);if(!i){return}if(x){i.checked=true}else{var r=w.getAttribute("childgroupidsuffixes");if(r&&r!=""){var s=r.split(";");for(var v=0;v<s.length;v=v+1){var y=s[v];if(!y||y==""){continue}var t=document.getElementById(z+y);if(!t){continue}var q=getSelectCheckBoxObj(t);if(q.checked){x=true;break}}}else{var o=w.getAttribute("childdataidsuffixes");if(o&&o!=""){var p=o.split(";");for(var v=0;v<p.length;v=v+1){var y=p[v];if(!y||y==""){continue}var t=document.getElementById(z+y);if(!t){continue}var q=getSelectCheckBoxObj(t);if(q.checked){x=true;break}}}}if(x){i.checked=true}else{i.checked=false}}selectParentDataRows(z,w.getAttribute("parenttridsuffix"),x)}function getSelectCheckBoxObj(l){var j=l.getElementsByTagName("INPUT");var k=null;for(var n=0,i=j.length;n<i;n=n+1){var h=j[n].getAttribute("name");var m=j[n].getAttribute("type");if(!m||m!="checkbox"){continue}if(!h||h.indexOf("_rowselectbox_col")<=0){continue}k=j[n];break}return k}function getSelectRadioBoxObj(k){var j=k.getElementsByTagName("INPUT");var l=null;for(var n=0,i=j.length;n<i;n=n+1){var h=j[n].getAttribute("name");var m=j[n].getAttribute("type");if(!m||m!="radio"){continue}if(!h||h.indexOf("_rowselectbox_col")<=0){continue}l=j[n];break}return l}function doSelectedAllDataRowChkRadio(e){var h=e.getAttribute("name");var f=h.lastIndexOf("_rowselectbox");if(f<=0){return}var g=h.substring(0,f);WX_selected_selectBoxObj_temp=e;if(isHasIgnoreSlaveReportsSavingData(g)){wx_confirm("本操作可能会丢失对从报表数据的修改，是否继续？",null,null,null,doSelectedAllDataRowChkRadioImpl,cancelSelectDeselectChkRadio)}else{doSelectedAllDataRowChkRadioImpl("ok")}}function doSelectedAllDataRowChkRadioImpl(u){if(!wx_isOkConfirm(u)){wx_callCancelEvent();return}var B=WX_selected_selectBoxObj_temp;WX_selected_selectBoxObj_temp=null;initRowSelect();var s=new Array();var E=new Array();var i=B.getAttribute("name");var t=i.lastIndexOf("_rowselectbox");if(t<=0){return}var D=i.substring(0,t);var v=document.getElementsByName(i+"_col");if(!v||v.length==0){return}var A=false;if(B.checked){A=true}var y;var w;var F;var r=new Object();for(var z=0,x=v.length;z<x;z=z+1){y=v[z];if(y==null){continue}var C=y.getAttribute("rowgroup");if(C=="true"){y.checked=A;continue}w=getSelectedTrParent(y);if(w==null){continue}F=y.checked;if(A){selectDataRow(w,false);y.checked=true;if(!F&&r[w.getAttribute("id")]!="true"){s[s.length]=w;r[w.getAttribute("id")]="true"}}else{deselectDataRow(w);y.checked=false;if(F&&r[w.getAttribute("id")]!="true"){E[E.length]=w;r[w.getAttribute("id")]="true"}}}invokeRowSelectedMethods(getPageIdByComponentGuid(D),getComponentIdByGuid(D),s,E)}function selectDataRow(g,k){var j=g.getAttribute("id");var h=j.substring(0,j.lastIndexOf("_tr_"));if(h==""){return}var i=WX_selectedTrObjs[h];if(!i){i=new Object();WX_selectedTrObjs[h]=i}i[j]=g;if(k){var l=j.substring(j.lastIndexOf("_")+1);WX_startTrIdxMap[h]=l}setTrBgcolorInSelect(g,h)}function deselectDataRow(e){resetTrBgcolorInSelect(e);if(!WX_selectedTrObjs){return}var h=e.getAttribute("id");var f=h.substring(0,h.lastIndexOf("_tr_"));if(f==""){return}var g=WX_selectedTrObjs[f];if(g!=null&&g[h]!=null){delete g[h]}if(WX_startTrIdxMap!=null&&WX_startTrIdxMap[f]!=null){delete WX_startTrIdxMap[f]}}function deselectAllDataRow(g){var i=null;var f=new Object();if(WX_selectedTrObjs!=null){var h=WX_selectedTrObjs[g];if(h!=null){i=new Array();for(var j in h){resetTrBgcolorInSelect(h[j]);if(h[j]==null){continue}if(f[h[j].getAttribute("id")]!="true"){i[i.length]=h[j];f[h[j].getAttribute("id")]="true"}}}delete WX_selectedTrObjs[g]}if(WX_startTrIdxMap!=null){delete WX_startTrIdxMap[g]}return i}function getRealDeselectedTrObjs(l,i){if(l==null||l.length==0){return i}if(i==null||i.length==0){return i}var g=new Object();for(var k=0,h=l.length;k<h;k++){g[l[k].getAttribute("id")]="true"}var j=new Array();for(var k=0,h=i.length;k<h;k++){if(g[i[k].getAttribute("id")]=="true"){continue}j[j.length]=i[k]}return j}function getSelectedTrParent(b){if(!b){return null}while(b!=null){if(isListReportDataTrObj(b)){return b}b=b.parentNode}return null}function isListReportDataTrObj(d){if(d.tagName!="TR"){return false}var f=d.getAttribute("id");if(!f||f==""){return false}var e=f.lastIndexOf("_tr_");if(e<=0){return false}if(f.indexOf("trgoup_")>0){return false}if(f.substring(0,e).indexOf(WX_GUID_SEPERATOR)>0&&parseInt(f.substring(e+4))>=0){return true}return false}function getSelectedTableParent(j){if(!j){return null}var i=j.getAttribute("id");var l=i.substring(0,i.lastIndexOf("_tr_"));if(l==""){return}var k=l+"_data";var g=j.parentNode;while(g!=null){if(g.tagName=="TABLE"){var h=g.getAttribute("id");if(!h||h!=k){return null}return g}g=g.parentNode}return null}function getRowSelectType(c){var d=getReportMetadataObj(c);if(d==null){return""}return d.metaDataSpanObj.getAttribute("rowselecttype")}function invokeRowSelectedMethods(q,o,l,i){if((l==null||l.length==0)&&(i==null||i.length==0)){return}var r=getComponentGuidById(q,o);var n=getReportMetadataObj(r);var s=n.metaDataSpanObj.getAttribute("rowSelectMethods");var m=getObjectByJsonString(s);if(m==null){return}var t=m.rowSelectMethods;if(t==null||t.length==0){return}for(var p=0;p<t.length;p=p+1){t[p].value(q,o,l,i)}}function setTrBgcolorInSelect(c,d){if(c==null){return}storeTdsOriginalBgColorInTr(c);setTdsBgColorInTr(c,WX_selectedRowBgcolor)}function resetTrBgcolorInSelect(b){if(b==null){return}resetTdsBgColorInTr(b)}function changeRowBgcolorOnMouseOver(c,d){if(c==null||!isListReportDataTrObj(c)){return}storeTdsOriginalBgColorInTr(c);setTdsBgColorInTr(c,d)}function resetRowBgcolorOnMouseOver(b){if(isSelectedRow(b)){setTdsBgColorInTr(b,WX_selectedRowBgcolor)}else{resetTdsBgColorInTr(b)}}function storeTdsOriginalBgColorInTr(l){if(l==null){return}if(isSetTrBgColorOnly(l)===true){var m=l.getAttribute("tr_original_bgcolor");if(m!=null&&m!=""){return}m=getElementBgColor(l);if(m==null||m==""){m="#ffffff"}l.setAttribute("tr_original_bgcolor",m)}else{var r,o,m,i;var k=l.cells;var q=false;for(var p=0,n=k.length;p<n;p++){i=k[p];r=i.getAttribute("groupcol");if(r=="true"){continue}o=i.getAttribute("isFixedCol");if(o=="true"){continue}if(!q){m=i.getAttribute("td_original_bgcolor");if(m!=null&&m!=""){return}q=true}m=getElementBgColor(i);if(m==null||m==""){m="#ffffff"}i.setAttribute("td_original_bgcolor",m)}}}function setTdsBgColorInTr(m,k){if(m==null){return}if(isSetTrBgColorOnly(m)===true){m.style.backgroundColor=k}else{var l=m.cells;var i,o,p;for(var n=0,j=l.length;n<j;n++){p=l[n];i=p.getAttribute("groupcol");if(i=="true"){continue}o=p.getAttribute("isFixedCol");if(o=="true"){continue}p.style.backgroundColor=k}}}function resetTdsBgColorInTr(m){if(isSetTrBgColorOnly(m)===true){var q=m.getAttribute("tr_original_bgcolor");if(q==null||q==""){return}m.style.backgroundColor=q}else{var r,o,k=0,q;var l=m.cells,i;for(var p=0,n=l.length;p<n;p++){i=l[p];r=i.getAttribute("groupcol");if(r=="true"){continue}o=i.getAttribute("isFixedCol");if(o=="true"){continue}q=i.getAttribute("td_original_bgcolor");if(q==null||q==""){return}i.style.backgroundColor=q}}}function isSetTrBgColorOnly(j){if(j==null){return true}var g=j.getAttribute("wx_isSetTrBgColorOnly_flag");if(g!=null&&g!=""){return g=="true"}var i=j.cells,l;for(var k=0,h=i.length;k<h;k++){l=i[k];isgroupcol=l.getAttribute("groupcol");isFixedCol=l.getAttribute("isFixedCol");if(isgroupcol=="true"||isFixedCol=="true"){j.setAttribute("wx_isSetTrBgColorOnly_flag","false");return false}}j.setAttribute("wx_isSetTrBgColorOnly_flag","true");return true}var WX_Current_Slave_TrObj;function shouldRefreshSlaveReportsForThisRow(h){var g=h.getAttribute("id");if(!g||g==""){return true}var e=g.substring(0,g.lastIndexOf("_tr_"));if(WX_Current_Slave_TrObj==null){WX_Current_Slave_TrObj=new Object()}var f=WX_Current_Slave_TrObj[e];if(f!=g){WX_Current_Slave_TrObj[e]=g;return true}return false}function clearCurrentSlaveTrObjForReport(e,f){if(WX_Current_Slave_TrObj==null){return}var d=getComponentGuidById(e,f);delete WX_Current_Slave_TrObj[d]}function getRefreshSlaveReportsHrefParams(j){var m=j.getElementsByTagName("TD");var n="";var h;var l;for(var k=0,i=m.length;k<i;k=k+1){h=m[k].getAttribute("slave_paramname");if(!h||h==""){continue}l=m[k].getAttribute("value");if(!l){l=""}if(n!=""){n=n+"&"}n=n+h+"="+l}return n}function initdrag(c,d){c.isInit=true;c.getTdWidthByIndex=function(i){var a=c.parentNode.parentNode.cells[c.parentNode.cellIndex+i];var h=a.style.width;if(h&&h!=""&&h.indexOf("%")<0){return parseInt(h)}if(window.ActiveXObject||isChrome||ISOPERA){return a.offsetWidth}else{var b=c.parentNode.parentNode.parentNode.parentNode.cellPadding;if(!b){b=1}var j=c.parentNode.parentNode.parentNode.parentNode.border;if(!j){j=1}else{if(parseInt(j)>=1){}}return parseInt(c.parentNode.parentNode.cells[c.parentNode.cellIndex+i].offsetWidth)-parseInt(b)*2-parseInt(j)}};c.setTdWidthByIndex=function(a,b){c.parentNode.parentNode.cells[a].style.width=b+"px"};c.firstChild.onmousedown=function(){return false};c.onmousedown=function(i){var a=document;if(!i){i=window.event}var b=i.clientX;var h=0;if(d){h=c.getTdWidthByIndex(0)+c.getTdWidthByIndex(1)}if(c.setCapture){c.setCapture()}else{if(window.captureEvents){window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}}a.onmousemove=function(f){if(!f){f=window.event}if(d&&c.getTdWidthByIndex(0)+c.getTdWidthByIndex(1)>h){c.setTdWidthByIndex(c.parentNode.cellIndex+1,h-c.getTdWidthByIndex(0));return}var e=f.clientX-b;if(e>0){if(d&&parseInt(c.parentNode.parentNode.cells[c.parentNode.cellIndex+1].style.width)-e<10){return}c.setTdWidthByIndex(c.parentNode.cellIndex,c.getTdWidthByIndex(0)+e);if(d){c.setTdWidthByIndex(c.parentNode.cellIndex+1,c.getTdWidthByIndex(1)-e)}else{c.parentNode.parentNode.parentNode.parentNode.style.width=(c.parentNode.parentNode.parentNode.parentNode.offsetWidth+e)+"px"}}else{if(parseInt(c.parentNode.parentNode.cells[c.parentNode.cellIndex].style.width)+e<10){return}c.setTdWidthByIndex(c.parentNode.cellIndex,c.getTdWidthByIndex(0)+e);if(d){c.setTdWidthByIndex(c.parentNode.cellIndex+1,c.getTdWidthByIndex(1)-e)}else{c.parentNode.parentNode.parentNode.parentNode.style.width=(c.parentNode.parentNode.parentNode.parentNode.offsetWidth+e)+"px"}}b=f.clientX};a.onmouseup=function(){if(c.releaseCapture){c.releaseCapture()}else{if(window.captureEvents){window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}}a.onmousemove=null;a.onmouseup=null}}}var dragrow_table;var dragrow_pageid;var dragrow_reportid;var _tempDragrowTarget;var _fromDragrowTarget;var _toDroprowTarget;var _isDragRow=false;var dragrow_enabled=true;function handleRowDragMouseDown(a,b,c){if(a.getAttribute("EDIT_TYPE")=="add"){return}if(_tempDragrowTarget!=null){handleRowMouseUp(a);return}if(!dragrow_enabled){return}_isDragRow=true;_fromDragrowTarget=a;_toDroprowTarget=a;dragrow_pageid=b;dragrow_reportid=c;dragrow_table=getParentElementObj(a,"TABLE");if(dragrow_table==null){return false}document.body.onselectstart=function(){return false};document.body.style.MozUserSelect="none";if(!dragrow_table.isInitRowDrag){dragrow_table.isInitRowDrag=true;var d;var e=dragrow_table.tBodies[0].rows;for(var i=0,len=e.length;i<len;i++){d=e[i];d.onmouseup=function(){handleRowMouseUp(this)}}}document.body.style.cursor="move";EventTools.addEventHandler(window.document.body,"mousemove",handleRowMouseMove);EventTools.addEventHandler(window.document.body,"mouseup",handleBodyRowMouseUp);_tempDragrowTarget=document.createElement("TABLE");_tempDragrowTarget.className=dragrow_table.className;var f=document.createElement("TBODY");f.appendChild(a.cloneNode(true));_tempDragrowTarget.appendChild(f);with(_tempDragrowTarget.style){display="none";position="absolute";zIndex=101;filter="Alpha(style=0,opacity=50)";opacity=0.5;width=dragrow_table.clientWidth;left=getElementAbsolutePosition(dragrow_table).left}if(dragrow_table.style.tableLayout!=null){_tempDragrowTarget.style.tableLayout=dragrow_table.style.tableLayout}document.body.appendChild(_tempDragrowTarget)}function handleBodyRowMouseUp(){document.body.style.cursor="";document.body.onselectstart=function(){return true};document.body.style.MozUserSelect="";_isDragRow=false;removeTempDragrowTarget();EventTools.removeEventHandler(window.document.body,"mousemove",handleRowMouseMove);EventTools.removeEventHandler(window.document.body,"mouseup",handleBodyRowMouseUp);_toDroprowTarget=null}function handleRowMouseUp(g){document.body.style.cursor="";removeTempDragrowTarget();if(!_isDragRow){return false}_isDragRow=false;EventTools.removeEventHandler(window.document.body,"mousemove",handleRowMouseMove);EventTools.removeEventHandler(window.document.body,"mouseup",handleBodyRowMouseUp);if(_toDroprowTarget!=null){var f=getParentElementObj(g,"TABLE");if(f==dragrow_table){if(g.getAttribute("EDIT_TYPE")=="add"){var h=dragrow_table.tBodies[0].rows;for(var e=h.length-1;e>=0;e--){if(h[e].getAttribute("EDIT_TYPE")=="add"){continue}if(!isListReportDataTrObj(h[e])){continue}g=h[e];break}}_toDroprowTarget=g;changeListReportRoworderByDrag()}_toDroprowTarget=null}document.body.onselectstart=function(){return true};document.body.style.MozUserSelect=""}function removeTempDragrowTarget(){if(_tempDragrowTarget!=null){if(_tempDragrowTarget.parentNode!=null){_tempDragrowTarget.parentNode.removeChild(_tempDragrowTarget)}else{_tempDragrowTarget.style.display="none"}_tempDragrowTarget=null}}function handleRowMouseMove(a){a=EventTools.getEvent(a);if(a.type.indexOf("mousemove")==-1){EventTools.removeEventHandler(window.document.body,"mousemove",handleRowMouseMove);EventTools.removeEventHandler(window.document.body,"mouseup",handleBodyRowMouseUp);return false}with(_tempDragrowTarget.style){top=(a.pageY+5)+"px";display=""}}function changeListReportRoworderByDrag(){if(_fromDragrowTarget==null||_toDroprowTarget==null||_fromDragrowTarget==_toDroprowTarget){return false}if(!isListReportDataTrObj(_toDroprowTarget)){return false}var m=_fromDragrowTarget.getAttribute("id");var k=_toDroprowTarget.getAttribute("id");if(m==k){return false}var l=parseInt(m.substring(m.lastIndexOf("_tr_")+"_tr_".length),10);var n=parseInt(k.substring(k.lastIndexOf("_tr_")+"_tr_".length),10);var j=l>n;var i=getRoworderUrl(dragrow_pageid,dragrow_reportid,_fromDragrowTarget);if(i==null||i==""){return false}var h=getRoworderParamsInTr(_toDroprowTarget);i=i+"&"+dragrow_reportid+"_ROWORDERTYPE=drag";i=i+"&"+dragrow_reportid+"_DESTROWPARAMS="+h;i=i+"&"+dragrow_reportid+"_ROWORDERDIRECT="+j;refreshComponent(i)}function changeListReportRoworderByArrow(s,o,p,r){var m=getValidParentTrObj(p);if(m==null){return false}var t=getRoworderUrl(s,o,m);var n=m.getAttribute("id");var k=parseInt(n.substring(n.lastIndexOf("_tr_")+"_tr_".length),10);var q=null;if(r&&k>0){q=document.getElementById(n.substring(0,n.lastIndexOf("_tr_")+"_tr_".length)+(k-1))}else{if(!r){q=document.getElementById(n.substring(0,n.lastIndexOf("_tr_")+"_tr_".length)+(k+1))}}if(q!=null&&q.getAttribute("EDIT_TYPE")!="add"){var l=getRoworderParamsInTr(q);t=t+"&"+o+"_DESTROWPARAMS="+l}t=t+"&"+o+"_ROWORDERTYPE=arrow";t=t+"&"+o+"_ROWORDERDIRECT="+r;refreshComponent(t)}var WX_Roworder_inputbox_pageid;var WX_Roworder_inputbox_reportid;var WX_Roworder_inputbox_trObj;var WX_Roworder_inputbox_newordervalue;function changeListReportRoworderByInputbox(g,f,j,h){if(j==null||j.value==null||j.value==""||j.value==h){return}var i=getValidParentTrObj(j);if(i==null){return}WX_Roworder_inputbox_pageid=g;WX_Roworder_inputbox_reportid=f;WX_Roworder_inputbox_trObj=i;WX_Roworder_inputbox_newordervalue=j.value;wx_confirm("确认修改此行排序值为"+j.value+"?","排序",null,null,doChangeListReportRoworderByInputbox)}function doChangeListReportRoworderByInputbox(d){if(wx_isOkConfirm(d)){var c=getRoworderUrl(WX_Roworder_inputbox_pageid,WX_Roworder_inputbox_reportid,WX_Roworder_inputbox_trObj);if(c==null||c==""){wx_warn("没有取到行排序所需的参数");return}c=c+"&"+WX_Roworder_inputbox_reportid+"_ROWORDERTYPE=inputbox";c=c+"&"+WX_Roworder_inputbox_reportid+"_ROWORDERVALUE="+WX_Roworder_inputbox_newordervalue;refreshComponent(c)}WX_Roworder_inputbox_pageid=null;WX_Roworder_inputbox_reportid=null;WX_Roworder_inputbox_trObj=null;WX_Roworder_inputbox_newordervalue=null}function changeListReportRoworderByTop(g,f,i){var h=getValidParentTrObj(i);var j=getRoworderUrl(g,f,h);if(j==null||j==""){return}j=j+"&"+f+"_ROWORDERTYPE=top";refreshComponent(j)}function getValidParentTrObj(b){while(b!=null){if(b.tagName=="TR"&&isListReportDataTrObj(b)&&b.getAttribute("EDIT_TYPE")!="add"){return b}b=getParentElementObj(b,"TR")}return null}function getRoworderUrl(i,m,k){var n=getComponentGuidById(i,m);var j=getReportMetadataObj(n);var l=getComponentUrl(i,j.refreshComponentGuid,j.slave_reportid);var h=getRoworderParamsInTr(k);if(h==null||h==""){return null}l=l+"&"+m+"_ROWORDERPARAMS="+h;return l}function getRoworderParamsInTr(k){var h="";var n;var m,j;for(var l=0,i=k.cells.length;l<i;l++){n=k.cells[l];m=n.getAttribute("name");if(m==null||m==""){continue}j=n.getAttribute("value");if(j==null){j=""}h=h+m+SAVING_NAMEVALUE_SEPERATOR+encodeURIComponent(j)+SAVING_COLDATA_SEPERATOR}if(h.lastIndexOf(SAVING_COLDATA_SEPERATOR)==h.length-SAVING_COLDATA_SEPERATOR.length){h=h.substring(0,h.length-SAVING_COLDATA_SEPERATOR.length)}return h}var drag_table;var drag_pageid;var drag_reportid;var _tempDragTarget;var _fromDragTarget;var _toDropTarget;var _isDrag=false;var drag_enabled=true;function insertAfter(f,e){var d=e.parentNode;if(d.lastChild==e){d.appendChild(f)}else{d.insertBefore(f,e.nextSibling)}}function setTempDragTarget(b){_tempDragTarget.innerHTML=b.innerHTML;_tempDragTarget.className="dragShadowOnMove";_tempDragTarget.style.display="none";_tempDragTarget.style.height=b.clientHeight+"px";_tempDragTarget.style.width=b.clientWidth+"px"}function handleCellDragMouseDown(q,r,m){if(!drag_enabled){return false}_isDrag=true;_tempDragTarget=document.getElementById("dragShadowObjId");if(!_tempDragTarget){_tempDragTarget=document.createElement("DIV");_tempDragTarget.style.display="none";_tempDragTarget.id="dragShadowObjId";document.body.appendChild(_tempDragTarget)}setTempDragTarget(q);_fromDragTarget=q;_toDropTarget=q;drag_pageid=r;drag_reportid=m;drag_table=getParentElementObj(q,"TABLE");if(!drag_table){return false}document.body.onselectstart=function(){return false};document.body.style.MozUserSelect="none";if(!drag_table.isInitCellDrag){drag_table.isInitCellDrag=true;for(var n=0,l=drag_table.tBodies[0].rows.length;n<l;n++){var i=drag_table.tBodies[0].rows[n].cells;for(var o=0,p=i.length;o<p;o++){var j=i[o];j.onmouseover=function(){handleMouseOver(this)};j.onmouseout=function(){handleMouseOut()};j.onmouseup=function(){handleMouseUp(this)}}}}document.body.style.cursor="move";EventTools.addEventHandler(window.document.body,"mousemove",handleMouseMove);EventTools.addEventHandler(window.document.body,"mouseup",handleBodyMouseUp)}function handleBodyMouseUp(){document.body.style.cursor="";document.body.onselectstart=function(){return true};document.body.style.MozUserSelect="";_isDrag=false;EventTools.removeEventHandler(window.document.body,"mousemove",handleMouseMove);EventTools.removeEventHandler(window.document.body,"mouseup",handleBodyMouseUp);_tempDragTarget.style.display="none";if(_toDropTarget){_toDropTarget=null}}function handleMouseUp(c){document.body.style.cursor="";if(!_isDrag){return false}_isDrag=false;EventTools.removeEventHandler(window.document.body,"mousemove",handleMouseMove);EventTools.removeEventHandler(window.document.body,"mouseup",handleBodyMouseUp);_tempDragTarget.style.display="none";if(_toDropTarget){var d=getParentElementObj(c,"TABLE");if(d==drag_table){_toDropTarget=c;moveTargetToByServer()}_toDropTarget=null}document.body.onselectstart=function(){return true};document.body.style.MozUserSelect=""}function handleMouseOver(c){if(!_isDrag){return false}var d=getParentElementObj(c,"TABLE");if(d==drag_table){document.body.style.cursor="move";_toDropTarget=c}}function handleMouseOut(){if(!_toDropTarget){return false}if(_isDrag){document.body.style.cursor="not-allowed"}_toDropTarget=null}function handleMouseMove(a){a=EventTools.getEvent(a);if(a.type.indexOf("mousemove")==-1){EventTools.removeEventHandler(window.document.body,"mousemove",handleMouseMove);EventTools.removeEventHandler(window.document.body,"mouseup",handleBodyMouseUp);return false}var x=a.pageX+10;var y=a.pageY+10;with(_tempDragTarget.style){left=x+"px";top=y+"px";display=""}}function moveTargetToByClient(){if(!_fromDragTarget||!_toDropTarget||_fromDragTarget==_toDropTarget){return false}var n=_fromDragTarget.cellIndex;var m=_toDropTarget.cellIndex;if(n==m){return}var j=true;if(n>m){j=false}for(var h=0;h<drag_table.tBodies[0].rows.length;h++){var k=drag_table.tBodies[0].rows[h];var l=k.cells[n];var i=k.cells[m];if(!j){k.insertBefore(l,i)}else{if(i.cellIndex==k.cells.length-1){k.appendChild(l)}else{k.insertBefore(l,k.cells[m+1])}}}}function moveTargetToByServer(){if(!_fromDragTarget||!_toDropTarget||_fromDragTarget==_toDropTarget){return false}var i=getThOfDropTargetTd();if(i==0){return}var h=_fromDragTarget.getAttribute("dragcolid");var k=_toDropTarget.getAttribute("dragcolid");if(!h||!k||h==k){return}var g=getComponentGuidById(drag_pageid,drag_reportid);var j=getReportMetadataObj(g);var l=getComponentUrl(drag_pageid,j.refreshComponentGuid,j.slave_reportid);l=replaceUrlParamValue(l,drag_reportid+"_DRAGCOLS",h+";"+k);l=l+"&"+drag_reportid+"_DRAGDIRECT="+i;WX_showProcessingBar=false;refreshComponent(l)}function getThOfDropTargetTd(){var r;var u;var i=_fromDragTarget.parentNode;for(var v=0,t=i.cells.length;v<t;v++){r=i.cells[v];u=r.getAttribute("dragcolid");if(u==null||u==""){continue}var n=getElementAbsolutePosition(_fromDragTarget).left;var q=_toDropTarget.offsetWidth;var s=getElementAbsolutePosition(_toDropTarget).left;var o=r.offsetWidth;var x=getElementAbsolutePosition(r).left;if(_fromDragTarget==r||n==x){continue}if(o<q){continue}if(x>s){continue}if(x<=s&&x+o>=s+q){var p=_fromDragTarget.getAttribute("parentGroupid");var w=r.getAttribute("parentGroupid");if(!p&&!w||p==w){_toDropTarget=r;if(n==x){return 0}if(n>x){return -1}if(n<x){return 1}}}}return 0}function clickorderby(p,o){var j=getParentElementObj(p,"TABLE");if(!j){return false}var q=j.getAttribute("pageid");var m=j.getAttribute("reportid");var l=j.getAttribute("refreshComponentGuid");var n=j.getAttribute("isSlave");var k=null;if(n&&n=="true"){k=m}var r=getComponentUrl(q,l,k);r=replaceUrlParamValue(r,m+"ORDERBY",o);r=replaceUrlParamValue(r,m+"ORDERBY_ACTION","true");refreshComponent(r)}var COL_FILTER_btnObj;var COL_FILTER_selectSpanTitleStart="<span style='width:100%;display:block;' class='spanOutputTitleElement'>";var COL_FILTER_selectSpanStart="<span style='width:100%;display:block;'  class='spanOutputNormalElement' onmouseover='setHighColor(this)' ";var COL_FILTER_selectSpanEnd="</span>";function closeAllColFilterResultSpan(){if(COL_FILTER_btnObj){var c=document.getElementById(COL_FILTER_btnObj.obj.spanOutputId);if(c){c.style.display="none"}COL_FILTER_btnObj.obj.currentValueSelected=-1}COL_FILTER_btnObj=null;var d=document.getElementById("wx_titletree_container");if(d!=null){closeSelectedTree()}}function getFilterDataList(o,u){closeAllColFilterResultSpan();COL_FILTER_btnObj=o;var t=getObjectByJsonString(u);var y=t.filterwidth;var w=getParentElementObj(o,"TD");if(o.obj==null||((y==null||y<=0)&&o.obj.spanOutputWidth!=w.offsetWidth)){o.obj=initializeFilter(o,t,-1)}o.obj.paramsObj=t;var p=getReportMetadataObj(t.reportguid);o.obj.metadataObj=p;var x=p.pageid;var s=p.reportid;var r=p.refreshComponentGuid;var q=p.slave_reportid;var z=getComponentUrl(x,r,q);z=replaceUrlParamValue(z,"REPORTID",s);z=replaceUrlParamValue(z,"ACTIONTYPE","GetFilterDataList");z=replaceUrlParamValue(z,"FILTER_COLPROP",t.property);if(z!=null&&z!=""){var k=z.split("?");if(k==null||k.length<=1){k[1]=""}else{if(k.length>=2){if(k.length>2){for(var v=2;v<k.length;v=v+1){k[1]=k[1]+"?"+k[v]}}}}XMLHttpREPORT.sendReq("POST",k[0],k[1],buildFilterItems,onGetDataErrorMethod,"")}}function initializeFilter(l,m,i){var o={elem:l,paramsObj:null,metadataObj:null,spanOutputWidth:null,resultItemsXmlRoot:null,recordCount:0,treeNodesArr:null,spanOutputId:"",currentValueSelected:-1,prevValueSelected:-1};if(l.id){o.spanOutputId="spanOutput_"+l.id}else{alert("必须给用于点击的按钮对象分配一id属性")}var p=getParentElementObj(l,"TD");var n=m.filterwidth;if(n!=null&&n<=0){o.spanOutputWidth=p.offsetWidth}else{o.spanOutputWidth=n}if(m.multiply&&m.multiply=="false"){var j=document.getElementById(o.spanOutputId);if(j==null){var k=document.createElement("span");k.id=o.spanOutputId;k.className="spanOutputTextDropdown";document.body.appendChild(k);j=k}}o.paramsObj=m;return o}function setHighColor(d){if(d){var f=d.id.split("_");COL_FILTER_btnObj.obj.prevValueSelected=COL_FILTER_btnObj.obj.currentValueSelected;COL_FILTER_btnObj.obj.currentValueSelected=f[f.length-1]}if(parseInt(COL_FILTER_btnObj.obj.prevValueSelected)>=0){document.getElementById(COL_FILTER_btnObj.obj.spanOutputId+"_"+COL_FILTER_btnObj.obj.prevValueSelected).className="spanOutputNormalElement"}var e=document.getElementById(COL_FILTER_btnObj.obj.spanOutputId+"_"+COL_FILTER_btnObj.obj.currentValueSelected);if(e){e.className="spanOutputHighElement"}}function onGetDataErrorMethod(b){if(WXConfig.load_error_message!=null&&WXConfig.load_error_message!=""){wx_error(WXConfig.load_error_message)}COL_FILTER_btnObj.obj.currentValueSelected=-1}function buildFilterItems(c){var d=c.responseXML;COL_FILTER_btnObj.obj.resultItemsXmlRoot=d.getElementsByTagName("items")[0];if(COL_FILTER_btnObj.obj.resultItemsXmlRoot){COL_FILTER_btnObj.obj.recordCount=COL_FILTER_btnObj.obj.resultItemsXmlRoot.childNodes.length}else{COL_FILTER_btnObj.obj.recordCount=0}buildSelectListBox()}function buildSelectListBox(){var S=getElementAbsolutePosition(getParentElementObj(COL_FILTER_btnObj,"TD"));var z=document;if(COL_FILTER_btnObj.obj.paramsObj.multiply=="false"){var K=makeFilterSelectList();if(K.length>0){var L=z.getElementById(COL_FILTER_btnObj.obj.spanOutputId);L.innerHTML=K;z.getElementById(COL_FILTER_btnObj.obj.spanOutputId+"_0").className="spanOutputHighElement";COL_FILTER_btnObj.obj.currentValueSelected=0;L.style.display="block";setOutputPosition(S,L,L,z.getElementById(COL_FILTER_btnObj.obj.spanOutputId+"_inner"));EventTools.addEventHandler(window.document,"mousedown",handleDocumentMouseDownForSingleColFilter)}else{hideSingleColFilterSelectBox()}}else{var F=COL_FILTER_btnObj.obj.recordCount;if(F<=0){return}var i=COL_FILTER_btnObj.obj.paramsObj;var J=getReportMetadataObj(i.reportguid);var G=J.metaDataSpanObj.getAttribute("lazydataload")=="true";var Q=i.webroot;var H=i.skin;var M=Q+"webresources/skin/"+H+"/images/coltitle_selected/";var V='{img_rooturl:"'+M+'"';V=V+',checkbox:"true"';V=V+',treenodeimg:"false"';V=V+",nodes:[";var N=new Array();var A;var T=COL_FILTER_btnObj.obj.resultItemsXmlRoot.childNodes;var I="";var O="";for(var E=0;E<F;E=E+1){var U=T.item(E);if(U.childNodes.length<=0){continue}I=U.firstChild.childNodes[0].nodeValue;var R=U.firstChild.getAttribute("isChecked");if(G||R==null||R==""){R="false"}if(U.childNodes.length==1){O=I}else{O=U.lastChild.childNodes[0].nodeValue}if(I&&(I=="[nodata]"||I=="[error]")){V=O;break}var P="col_filter_"+E;A=new Object();A.nodeid=P;A.nodevalue=I;N[N.length]=A;V=V+'{nodeid:"'+P+'"';V=V+',title:"'+O+'"';V=V+',checked:"'+R+'"';V=V+"},"}if(V.lastIndexOf(",")==V.length-1){V=V.substring(0,V.length-1)}COL_FILTER_btnObj.obj.treeNodesArr=N;var C='<ul class="bbit-tree-root bbit-tree-lines">';if(V.indexOf("nodes:[")<0&&V.indexOf("{img_rooturl:")<0){C=C+V}else{V=V+"]}";C=C+showTreeNodes(V)}C=C+"</ul>";var B=z.getElementById("wx_titletree_content");B.innerHTML=C;var D=z.getElementById("wx_titletree_container");D.style.display="";z.getElementById("wx_titletree_buttoncontainer").innerHTML='<img src="'+M+'submit.gif" onclick="okSelectedColFilter()">';setOutputPosition(S,D,z.getElementById("titletree_container_inner"),B);EventTools.addEventHandler(window.document,"mousedown",handleDocumentMouseDownForSelectedTree)}}function setOutputPosition(h,i,f,g){i.style.width=COL_FILTER_btnObj.obj.spanOutputWidth+"px";i.style.top=(h.top+h.height)+"px";i.style.left=(h.left+h.width-i.offsetWidth)+"px";var j=COL_FILTER_btnObj.obj.paramsObj.filtermaxheight;if(j==null||j<15){j=350}if(g.offsetHeight<j-10){f.style.height=(g.offsetHeight+10)+"px"}else{f.style.height=j+"px"}}function okSelectedColFilter(){var k=COL_FILTER_btnObj.obj.treeNodesArr;var l="";if(k&&k.length>0){var h;var j;var n=0;for(var m=0;m<k.length;m++){h=k[m];j=document.getElementById(h.nodeid);var i=j.getAttribute("checked");if(i&&i=="true"){l=l+h.nodevalue+";;";n++}}if(n==k.length){l=""}else{if(l.lastIndexOf(";;")==l.length-2){l=l.substring(0,l.length-2)}if(l==""){wx_warn("请选择要过滤的数据");return false}}filterReportData(l)}closeSelectedTree()}function makeFilterSelectList(){var l=new Array();if(!COL_FILTER_btnObj.obj.resultItemsXmlRoot){return""}var o="";var k="";var m="";var r=COL_FILTER_btnObj.obj.recordCount;if(r<=0){return""}var i=COL_FILTER_btnObj.obj.resultItemsXmlRoot.childNodes;for(var q=0;q<r;q=q+1){var p=i.item(q);if(p.childNodes.length<=0){COL_FILTER_btnObj.obj.recordCount--;continue}k=p.firstChild.childNodes[0].nodeValue;if(p.childNodes.length==1){m=k}else{m=p.lastChild.childNodes[0].nodeValue}var n=" id='"+COL_FILTER_btnObj.obj.spanOutputId+"_"+q+"'";if(k&&k!=""&&k!="[nodata]"&&k!="[error]"){n=n+" onmousedown=\"filterReportData('"+k+"')\""}n=n+">"+m;o+=COL_FILTER_selectSpanStart+n+COL_FILTER_selectSpanEnd}if(COL_FILTER_btnObj.obj.recordCount<=0){return""}o="<div id='"+COL_FILTER_btnObj.obj.spanOutputId+"_inner'>"+o+"</div>";return o}function filterReportData(g){var f=COL_FILTER_btnObj.obj.metadataObj;var e=getComponentUrl(f.pageid,f.refreshComponentGuid,f.slave_reportid);var h=COL_FILTER_btnObj.obj.paramsObj.urlParamName;e=replaceUrlParamValue(e,h,g);if(COL_FILTER_btnObj.obj.paramsObj.multiply!="false"){e=removeReportNavigateInfosFromUrl(e,f,1);e=replaceUrlParamValue(e,f.reportid+"_COL_FILTERID",h)}else{e=removeReportNavigateInfosFromUrl(e,f,null);hideSingleColFilterSelectBox()}refreshComponent(e)}function handleDocumentMouseDownForSingleColFilter(d){var e=window.event?window.event.srcElement:d.target;if(e==null){hideSingleColFilterSelectBox()}else{while(e!=null){try{if(e.getAttribute("id")==COL_FILTER_btnObj.obj.spanOutputId){return}e=e.parentNode}catch(f){break}}hideSingleColFilterSelectBox()}}function hideSingleColFilterSelectBox(){if(COL_FILTER_btnObj!=null){document.getElementById(COL_FILTER_btnObj.obj.spanOutputId).style.display="none";COL_FILTER_btnObj.obj.currentValueSelected=-1}EventTools.removeEventHandler(window.document,"mousedown",handleDocumentMouseDownForSingleColFilter)}var WX_colSeletedParamsObj=null;function createTreeObjHtml(ae,Y,aa){var O=document;var e=getObjectByJsonString(Y);var S=e.skin;var ai=e.webroot;var am=e.reportguid;var U=getReportMetadataObj(am);var ao={metadataObj:U,paramsObj:e};if(WX_colSeletedParamsObj==null){WX_colSeletedParamsObj=new Object()}WX_colSeletedParamsObj[am]=ao;var ah=O.getElementById(am+"_col_titlelist");if(ah==null){return}var al=ah.getElementsByTagName("ITEM");var ag;var M;var X;var T;var i;var Q;var aj;var W;var ap;var af=ai+"webresources/skin/"+S+"/images/coltitle_selected/";var ar='{img_rooturl:"'+af+'"';ar=ar+',checkbox:"true"';ar=ar+',treenodeimg:"true"';ar=ar+",nodes:[";var ac="";for(var N=0,L=al.length;N<L;N=N+1){ag=al[N];X=ag.getAttribute("nodeid");ar=ar+'{nodeid:"'+X+'"';ar=ar+',title:"'+ag.getAttribute("title")+'"';T=ag.getAttribute("parentgroupid");if(T!=null&&T!=""){ar=ar+',parentgroupid:"'+T+'"';ac=ac+X+':"'+T+'",'}i=ag.getAttribute("childids");if(i&&i!=""){ar=ar+',childids:"'+i+'"'}Q=parseInt(ag.getAttribute("layer"),10);if(!Q){Q=0}ar=ar+',layer:"'+Q+'"';aj=ag.getAttribute("checked");if(!aj){aj="false"}ar=ar+',checked:"'+aj+'"';W=ag.getAttribute("isControlCol");if(W=="true"){ap="hidden"}else{ap=ag.getAttribute("always");if(ap==null){ap="false"}}ar=ar+',isalway:"'+ap+'"';ar=ar+"},"}if(ar.lastIndexOf(",")==ar.length-1){ar=ar.substring(0,ar.length-1)}ar=ar+"]";if(ac.lastIndexOf(",")==ac.length-1){ac=ac.substring(0,ac.length-1)}ar=ar+",parentidsMap:{"+ac+"}";ar=ar+"}";var ab='<ul class="bbit-tree-root bbit-tree-lines">';ab=ab+showTreeNodes(ar);ab=ab+"</ul>";var R=O.getElementById("wx_titletree_content");R.innerHTML=ab;O.getElementById("wx_titletree_buttoncontainer").innerHTML='<img src="'+af+'submit.gif" onclick="okSelected(\''+am+"')\">";var ak=getElementAbsolutePosition(ae);var ad=O.getElementById("wx_titletree_container");if(e.width!=null&&e.width>0){ad.style.width=e.width+"px"}ad.style.display="";var an=e.maxheight;if(an==null||an<15){an=350}if(R.offsetHeight<an-10){O.getElementById("titletree_container_inner").style.height=(R.offsetHeight+10)+"px"}else{O.getElementById("titletree_container_inner").style.height=an+"px"}var P=aa||window.event;var aq=getDocumentSize();var V=aq.width-P.clientX;var Z=aq.height-P.clientY;if(V<ad.offsetWidth){ad.style.left=(ak.left-ad.offsetWidth)+"px"}else{ad.style.left=(ak.left+ak.width)+"px"}if(Z<ad.offsetHeight&&P.clientY>ad.offsetHeight){ad.style.top=(ak.top-ad.offsetHeight+ak.height)+"px"}else{ad.style.top=(ak.top)+"px"}EventTools.addEventHandler(window.document,"mousedown",handleDocumentMouseDownForSelectedTree)}function okSelected(D){var t=document;var y=WX_colSeletedParamsObj[D];var z=t.getElementById(D+"_col_titlelist");var r=z.getElementsByTagName("ITEM");var v="";var w;var A;var E;var C=false;for(var B=0,x=r.length;B<x;B++){nodeItemObj=r[B];E=nodeItemObj.getAttribute("nodeid");A=t.getElementById(E);if(A==null){continue}w=A.getAttribute("checked");if(w&&w=="true"){v=v+E+";";if(!C&&nodeItemObj.getAttribute("isNonFixedCol")=="true"){C=true}}}if(!C){wx_warn("至少选中一个非冻结数据列");return false}if(v.lastIndexOf(";")==v.length-1){v=v.substring(0,v.length-1)}if(v==""){wx_warn("请选择要显示/下载的列");return false}var s=y.metadataObj;var F=getComponentUrl(s.pageid,s.refreshComponentGuid,s.slave_reportid);F=replaceUrlParamValue(F,s.reportid+"_DYNDISPLAY_COLIDS",v);F=replaceUrlParamValue(F,s.reportid+"_DYNDISPLAY_COLIDS_ACTION","true");var u=y.paramsObj.showreport_onpage_url;var i=y.paramsObj.showreport_dataexport_url;if(u==null||i==null||i==""||u==i){refreshComponent(F)}else{exportData(s.pageid,s.reportid,y.paramsObj.includeApplicationids,u,i,F)}closeSelectedTree()}var WX_rootTreeNodeId="root_treenode_id";function showTreeNodes(a){var b=eval("("+a+")");var c=b.img_rooturl;var d=b.nodes;if(!d||d.length==0){return""}var e=b.parentidsMap;var f;var g="";var h=false;var j=false;var k="";var l=new Object();var m=b.checkbox;var n=b.treenodeimg;for(var i=0;i<d.length;i=i+1){f=d[i];id=f.nodeid;title=f.title;parentgroupid=f.parentgroupid;if(!parentgroupid||parentgroupid==""||parentgroupid==WX_rootTreeNodeId){parentgroupid=WX_rootTreeNodeId;k=k+id+","}childids=f.childids;if(!childids){childids=""}layer=parseInt(f.layer);if(!layer){layer=0}checked=f.checked;if(!checked){checked="false"}if(checked=="true"){j=true}isalway=f.isalway;if(isalway=="hidden"){continue}if(isalway==null){isalway="false"}if(isalway=="true"){h=true}g=g+"<div ";g=g+' title="'+title+'" id="'+id+'" parentgroupid="'+parentgroupid+'" childids="'+childids+'" layer="'+layer+'" always="'+isalway+'" checked="'+checked+'">';var o="";var p="";if(e&&parentgroupid!=WX_rootTreeNodeId){var q=e[parentgroupid];while(true){if(!q||q==""){q=WX_rootTreeNodeId}var r=l[q];if(!r||r!="true"){o="elbow-line.gif"}else{o="elbow-line-none.gif"}p="<img style='vertical-align:middle;' src=\""+c+o+'">'+p;if(q==WX_rootTreeNodeId){break}q=e[q]}}g=g+p;g=g+"<img ";if(isLastNodeInThisLayer(parentgroupid,i,d)){o="elbow-end.gif";l[parentgroupid]="true"}else{o="elbow.gif"}g=g+" style='vertical-align:middle;' src=\""+c+o+'">';if(n&&n=="true"){if(childids&&childids!=""){o="folder-open.gif"}else{o="leaf.gif"}g=g+"<img  style='vertical-align:middle;' src=\""+c+o+'">'}if(m&&m=="true"){if(isalway&&isalway=="true"){o="checkbox_3.gif"}else{if(checked&&checked=="true"){o="checkbox_1.gif"}else{o="checkbox_0.gif"}}g=g+'<img id="'+id+"_cb\" style='vertical-align:middle;'";if(!isalway||isalway=="false"){g=g+" onclick=\"processTreeNodeselected(this.id,'"+c+"')\""}g=g+' src="'+c+o+'">'}g=g+title;g=g+"</div>"}if(k.lastIndexOf(",")==k.length-1){k=k.substring(0,k.length-1)}var s='<div id="'+WX_rootTreeNodeId+'" childids="'+k+'" always="'+h+'" checked="'+j+"\"><img style='vertical-align:middle;' src=\""+c+'root.gif">';if(m&&m=="true"){var t="";if(h==true){t="checkbox_3.gif"}else{if(j==true){t="checkbox_1.gif"}else{t="checkbox_0.gif"}}s=s+'<img id="'+WX_rootTreeNodeId+"_cb\" style='vertical-align:middle;'";if(h!=true){s=s+" onclick=\"processTreeNodeselected(this.id,'"+c+"')\""}s=s+' src="'+c+t+'">'}s=s+"</div>";g=s+g;return g}function handleDocumentMouseDownForSelectedTree(c){var d=window.event?window.event.srcElement:c.target;if(d==null||!isElementOrChildElement(d,"wx_titletree_container")){closeSelectedTree()}}function closeSelectedTree(){document.getElementById("wx_titletree_container").style.display="none";EventTools.removeEventHandler(window.document,"mousedown",handleDocumentMouseDownForSelectedTree)}function isLastNodeInThisLayer(h,l,g){if(l==g.length-1){return true}if(!h){h=""}var i;for(var j=l+1;j<g.length;j++){i=g[j].parentgroupid;var k=g[j].isalway;if(k=="hidden"){continue}if(!i||i==""){i=WX_rootTreeNodeId}if(i!=h){continue}return false}return true}function processTreeNodeselected(g,j){var h=document.getElementById(g);var i=document.getElementById(g.substring(0,g.indexOf("_cb")));var l;var k=i.getAttribute("checked");if(k&&k=="true"){l=false;h.src=j+"checkbox_0.gif";i.setAttribute("checked","false")}else{l=true;h.src=j+"checkbox_1.gif";i.setAttribute("checked","true")}processChildNodesSelected(i,l,j);processParentNodesSelected(i,l,j)}function processChildNodesSelected(k,p,l){var j=k.getAttribute("childids");if(j&&j!=""){var i=j.split(",");var m;var n;for(var o=0;o<i.length;o++){if(i[o]==""){continue}m=document.getElementById(i[o]);if(!m){continue}n=document.getElementById(i[o]+"_cb");if(!n){continue}if(p){n.src=l+"checkbox_1.gif";m.setAttribute("checked","true")}else{n.src=l+"checkbox_0.gif";m.setAttribute("checked","false")}processChildNodesSelected(m,p,l)}}}function processParentNodesSelected(p,r,o){var i=p.getAttribute("parentgroupid");if(i&&i!=""){var w=document.getElementById(i);if(!w){return}var z=w.getAttribute("always");if(z&&z=="true"){return}if(r){w.setAttribute("checked","true");var t=document.getElementById(i+"_cb");t.src=o+"checkbox_1.gif"}else{var y=w.getAttribute("childids");var q=y.split(",");var u;var v=false;var s;for(var x=0;x<q.length;x++){if(q[x]==""){continue}u=document.getElementById(q[x]);if(!u){continue}s=u.getAttribute("checked");if(s&&s=="true"){v=true;break}}if(!v){w.setAttribute("checked","false");var t=document.getElementById(i+"_cb");t.src=o+"checkbox_0.gif"}}processParentNodesSelected(w,r,o)}}function expandOrCloseTreeNode(D,x,i,A,H){var C=getTrObjOfTreeGroupRow(i);var y;var J=C.getAttribute("childDataIdSuffixes");var v=C.getAttribute("childGroupIdSuffixes");if(!J||J==""){y=v}else{if(!v||v==""){y=J}else{y=v+";"+J}}if(y==null||y==""){return false}var F=C.getAttribute("state");if(!F||F==""){F="open"}var E=document.getElementById(C.getAttribute("id")+"_img");if(F=="open"){C.setAttribute("state","close");E.src=D+"webresources/skin/"+x+"/images/nodeclosed.gif"}else{C.setAttribute("state","open");E.src=D+"webresources/skin/"+x+"/images/nodeopen.gif"}var z=new Object();var e=y.split(";");for(var w=0;w<e.length;w=w+1){if(e[w]==""){continue}var I=document.getElementById(A+e[w]);if(!I){continue}var G=isExistParentStateClosed(A,I,z);if(!G){I.style.display=""}else{I.style.display="none"}}if(H&&H!=""){try{var B=document.getElementById(H);if(B){B.fleXcroll.updateScrollBars()}}catch(u){}}}function isExistParentStateClosed(k,l,m){var h=l.getAttribute("parentTridSuffix");if(!h||h==""){return false}if(m[h]){return m[h]=="1"}var n=document.getElementById(k+h);var j=n.getAttribute("state");if(j&&j=="close"){m[h]="1";return true}var i=isExistParentStateClosed(k,n,m);if(i){m[h]="1"}else{m[h]="0"}return m[h]=="1"}function getTrObjOfTreeGroupRow(d){var e=d.parentNode;if(!e){return null}if(e.tagName=="TR"){var f=e.getAttribute("id");if(f&&f.indexOf("trgroup_")>0){return e}}return getTrObjOfTreeGroupRow(e)}function exportData(D,u,v,G,w,F){if(v==null||v==""){return}if(F==null||F==""){var z=new Array();var B=v.split(";");var H=new Object();for(var A=0,x=B.length;A<x;A++){if(B[A]!=null&&B[A]!=""&&H[B]!="true"){H[B[A]]="true";z[z.length]=B[A]}}if(z!=null&&z.length==1){var i=getComponentGuidById(D,z[0]);var s=getReportMetadataObj(i);if(s==null){F=getComponentUrl(D,null,null)}else{F=getComponentUrl(D,s.refreshComponentGuid,s.slave_reportid)}}else{F=getComponentUrl(D,null,null);var y=null;var E=null;var C=null;for(var A=0,x=z.length;A<x;A++){E=getComponentGuidById(D,z[A]);y=getReportMetadataObj(E);if(y==null||y.slave_reportid==null||y.slave_reportid==""){continue}C=getComponentUrl(D,y.refreshComponentGuid,y.slave_reportid);F=mergeUrlParams(F,C,false)}}}F=replaceUrlParamValue(F,"COMPONENTIDS",u);F=replaceUrlParamValue(F,"INCLUDE_APPLICATIONIDS",v);if(G.indexOf("?")>0){if(G.lastIndexOf("&")!=G.length-1){G=G+"&"}}else{if(G.lastIndexOf("?")!=G.length-1){G=G+"?"}}if(w.indexOf("?")>0){if(w.lastIndexOf("&")!=w.length-1){w=w+"&"}}else{if(w.lastIndexOf("?")!=w.length-1){w=w+"?"}}var t=F.indexOf(G);F=F.substring(0,t)+w+F.substring(t+G.length);postlinkurl(F,true)}function mergeUrlParams(m,q,s){if(m==null||m==""||q==null||q==""){return m}var r=splitUrlAndParams(m,false);var u=splitUrlAndParams(q,false);var o=r[0];var t=r[1];var v=u[1];if(v==null){return m}var w=null;var x=null;if(s){w=v;x=t}else{w=t;x=v}var p="?";if(w!=null){for(var n in w){o=o+p+n+"="+w[n];p="&";if(x!=null){delete x[n]}}}if(x!=null){for(var n in x){o=o+p+n+"="+x[n];p="&"}}return o}function reloadSelectBoxData(B,C,I,y,J){var F=getComponentGuidById(B,C);var z=getReportMetadataObj(F);var G=getComponentUrl(B,z.refreshComponentGuid,z.slave_reportid);var u="";if(!J){for(var H in y){if(H==null||H==""){continue}if(y[H]==null||y[H]==""){continue}y[H]=createGetColDataObjByString(y[H])}u=getChildIdAndParentValues(z,I,y)}else{var j=new Array();for(var i in y){u+=i+";";if(y[i]!=null&&y[i]!=""){var A=y[i].split(";");for(var x=0;x<A.length;x++){if(A[x]!=null&&A[x]!=""){j[j.length]=A[x]}}}}if(u!=""){u="condition:"+u}var E;var D;for(var w=0,v=j.length;w<v;w++){D=F+"_condition_"+j[w];E=document.getElementById(D);if(E==null){continue}G=replaceUrlParamValue(G,j[w],getInputBoxValue(D,E.getAttribute("typename")))}}G=replaceUrlParamValue(G,"SELECTBOXIDS_AND_PARENTVALUES",u);G=replaceUrlParamValue(G,"ACTIONTYPE","GetSelectBoxDataList");G=replaceUrlParamValue(G,"REPORTID",C);sendAsynRequestToServer(G,refreshSelectBoxData,onRefreshSelectBoxDataErrorMethod,true)}function getChildIdAndParentValues(t,z,A){var G=null,r=null,s=null,v=null;var x=z.getAttribute("id");var w="";if(t.reportfamily==ReportFamily.EDITABLELIST2||t.reportfamily==ReportFamily.LISTFORM||t.reportfamily==ReportFamily.EDITABLEDETAIL2||t.reportfamily==ReportFamily.EDITABLELIST){w="TD"}else{w="FONT"}var H=getInputboxParentElementObj(z,w);G=H.getAttribute("value_name");var E=getUpdateColDestObj(H,t.reportguid,t.reportfamily,null);if(E==null){r=getInputBoxValue(x,z.getAttribute("typename"))}else{r=getInputBoxLabel(x,z.getAttribute("typename"));v=getInputBoxValue(x,z.getAttribute("typename"));s=E.getAttribute("value_name")}var F="";var u=x.lastIndexOf("__");if(u>0){F=x.substring(u+2)}var y=null;if(F!=""){y=document.getElementById(t.reportguid+"_tr_"+F)}childSelectBoxParams="";var B;for(var D in A){if(y!=null){B=getEditableListReportColValuesInRow(y,A[D])}else{B=getEditableReportColValues(t.pageid,t.reportid,A[D],null)}var C=formatParentColValuesToParamsString(B,G,r,s,v);if(C==null||C==""){continue}childSelectBoxParams+="wx_inputboxid"+SAVING_NAMEVALUE_SEPERATOR+D;if(F!=""){childSelectBoxParams+="__"+F}childSelectBoxParams+=SAVING_COLDATA_SEPERATOR+C+SAVING_ROWDATA_SEPERATOR}if(childSelectBoxParams.lastIndexOf(SAVING_ROWDATA_SEPERATOR)==childSelectBoxParams.length-SAVING_ROWDATA_SEPERATOR.length){childSelectBoxParams=childSelectBoxParams.substring(0,childSelectBoxParams.length-SAVING_ROWDATA_SEPERATOR.length)}return childSelectBoxParams}function reloadSelectBoxDataByFocus(u,p,t,x){var q=createGetColDataObjByString(x);var r=t.getAttribute("id");var m=null;if(r.indexOf("__")>0){m=getEditableListReportColValuesInRow(getParentElementObj(t,"TR"),q)}else{m=getEditableReportColValues(u,p,q,null)}if(t.tagName=="TD"){var o=r.lastIndexOf("__td");r=r.substring(0,o)+r.substring(o+"__td".length)}var s=formatParentColValuesToParamsString(m,null,null,null,null);var v=getComponentGuidById(u,p);var n=getReportMetadataObj(v);var w=getComponentUrl(u,n.refreshComponentGuid,n.slave_reportid);s="wx_inputboxid"+SAVING_NAMEVALUE_SEPERATOR+r+SAVING_COLDATA_SEPERATOR+s;w=replaceUrlParamValue(w,"SELECTBOXIDS_AND_PARENTVALUES",s);w=replaceUrlParamValue(w,"ACTIONTYPE","GetSelectBoxDataList");w=replaceUrlParamValue(w,"REPORTID",p);sendAsynRequestToServer(w,refreshSelectBoxData,onRefreshSelectBoxDataErrorMethod,false)}function formatParentColValuesToParamsString(k,r,j,q,p){var n="";var o;var m;for(var l in k){o=k[l];if(o==null){continue}if(l==r){m=j}else{if(q!=null&&l==q){m=p}else{m=o.value;if((m==null||m=="")&&(o.value_name==null||o.value_name=="")){m=o.oldvalue}if(m==null){m=""}}}n+=l+SAVING_NAMEVALUE_SEPERATOR+encodeURIComponent(m)+SAVING_COLDATA_SEPERATOR}if(n.lastIndexOf(SAVING_COLDATA_SEPERATOR)==n.length-SAVING_COLDATA_SEPERATOR.length){n=n.substring(0,n.length-SAVING_COLDATA_SEPERATOR.length)}return n}function refreshSelectBoxData(a,b){var c=a.responseText;if(c==null||c==" "||c==""){return}var d=null;try{d=eval("("+c+")")}catch(e){wx_error("获取子下拉框选项失败");throw e}var f=d.pageid;var g=d.reportid;var h=d.isConditionBox;delete d.pageid;delete d.reportid;delete d.isConditionBox;var i=getComponentGuidById(f,g);var j=getReportMetadataObj(i);var k;var l=document;for(var m in d){k=d[m];if(k==null||k.length==0){continue}if(k[0].selectboxtype=="selectbox"){filledChildSelectboxOptions(j,m,k,b)}else{if(k[0].selectboxtype=="checkbox"){}else{if(k[0].selectboxtype=="radiobox"){}else{continue}}}}}function filledChildSelectboxOptions(m,r,p,i){var t=document.getElementById(r);if(t==null){return}var l;if(i){l=getInputBoxValue(r,t.getAttribute("typename"))}else{var s=getParentElementObj(t,"TD");s=getUpdateColDestObj(s,m.reportguid,m.reportfamily,s);l=s.getAttribute("value")}if(l==null){l=""}if(t.options.length>0){for(var o=0,q=t.options.length;o<q;o++){t.remove(t.options[o])}}if(p.length<=1){return}var n;for(var o=1;o<p.length;o++){n=new Option(p[o].name,p[o].value);t.options.add(n);if(isSelectedValueForSelectedBox(l,p[o].value,t)){n.selected=true}}if(i){t.focus();if(t.onchange){t.onchange()}}}function onRefreshSelectBoxDataErrorMethod(b){wx_error("获取子选择框选项数据失败")}function createGetColDataObjByString(g){var h=new Object();var f=g.split(";");for(var e=0;e<f.length;e++){if(f[e]==null||f[e]==""){continue}h[f[e]]=true}return h}function popupPageByPopupInputbox(l,q){var n=document.getElementById(l);if(n==null){wx_warn("没有取到id为"+l+"的弹出输入框");return}var s=n.value;if(s==null){s=""}var p=getObjectByJsonString(q);if(p==null){wx_warn("没有取到id为"+inputboxid+"的弹出输入框参数，无法弹出窗口");return}var t=p.pageid;var o=p.reportid;var r=p.popupPageUrl;var u=getComponentGuidById(t,o);var m=getReportMetadataObj(u);r=replaceDynParamsInPoppageUrl(m,p,n,r);var v="?";if(r.indexOf("?")>0){v="&"}r=r+v+"SRC_PAGEID="+t;r=r+"&SRC_REPORTID="+o;r=r+"&INPUTBOXID="+l;r=r+"&OLDVALUE="+encodeURIComponent(s);wx_winpage(r,getObjectByJsonString(p.popupparams))}function popupPageByFileUploadInputbox(n,s,z){var p=document.getElementById(n);if(p==null){wx_warn("没有取到id为"+n+"的文件上传输入框");return}var t=null;if(z=="image"){t=p.getAttribute("srcpath")}else{t=p.value}if(t==null){t=""}var r=getObjectByJsonString(s);if(r==null){wx_warn("没有取到id为"+inputboxid+"的文件上传输入框参数，无法弹出窗口");return}var w=r.pageid;var q=r.reportid;var v=r.popupPageUrl;var x=getComponentGuidById(w,q);var o=getReportMetadataObj(x);v=replaceDynParamsInPoppageUrl(o,r,p,v);var u=WXConfig.showreport_url;var y="?";if(u.indexOf("?")>0){y="&"}if(v!=null&&v!=""){u+=y+v;y="&"}u=u+y+"PAGEID="+w+"&REPORTID="+q+"&INPUTBOXID="+n+"&ACTIONTYPE=ShowUploadFilePage&FILEUPLOADTYPE=fileinputbox";u=u+"&OLDVALUE="+encodeURIComponent(t);wx_winpage(u,getObjectByJsonString(r.popupparams))}function replaceDynParamsInPoppageUrl(A,i,C,F){if(F==null||F==""){return F}var G=A.pageid;var K=A.reportguid;var J=i.paramColumns;var H=i.paramConditions;if(J!=null&&J!=""){var w=createGetColDataObjByString(J);var B=null;if(A.reportfamily==ReportFamily.EDITABLELIST2||A.reportfamily==ReportFamily.LISTFORM){var E=getTrDataObj(K,C);if(E!=null){B=getEditableListReportColValuesInRow(E,w)}}else{if(A.reportfamily==ReportFamily.EDITABLEDETAIL2){B=getEditableDetailReportColValues(G,K,w,true)}else{if(A.reportfamily==ReportFamily.EDITABLEDETAIL||A.reportfamily==ReportFamily.FORM){B=getEditableDetailReportColValues(G,K,w,false)}else{return}}}if(B!=null){var L,I;for(var v in B){L=B[v];var N="@{"+L.name+"}";I=L.value;if((I==null||I=="")&&(L.value_name==null||L.value_name=="")){I=L.oldvalue}if(I==null){I=""}while(F.indexOf(N)>=0){F=F.replace(N,encodeURIComponent(I))}}}for(var v in w){var N="@{"+v+"}";while(F.indexOf(N)>=0){F=F.replace(N,"")}}}if(H!=null&&H!=""){var y=H.split(";");var M,D,z;for(var x=0;x<y.length;x++){M=y[x];if(M==null||M==""){continue}z=document.getElementById(K+"_condition_"+M);if(z==null){D=""}else{D=getInputBoxValue(z.getAttribute("id"),z.getAttribute("typename"));if(D==null){D=""}}var N="condition{"+M+"}";while(F.indexOf(N)>=0){F=F.replace(N,encodeURIComponent(D))}}}return F}function getTrDataObj(e,d){if(d==null){return null}var f=getParentElementObj(d,"TR");while(f!=null){if(isEditableListReportTr(e,f)){return f}f=getParentElementObj(f,"TR")}return null}var WX_PARENT_INPUTBOXID="";function setPopUpBoxValueToParent(l,n,m,h,j){var k=document.getElementById(n);if(!k){wx_warn("没有取到id为"+n+"的弹出源输入框");return false}WX_PARENT_INPUTBOXID=n;if(k.tagName=="IMG"){k.src=l;k.setAttribute("srcpath",l)}else{k.value=l}if(n.indexOf(h+"_condition_")<0){addInputboxDataForSaving(h,k);var i=getReportMetadataObj(h);if(i.reportfamily==ReportFamily.EDITABLELIST2||i.reportfamily==ReportFamily.LISTFORM||i.reportfamily==ReportFamily.EDITABLEDETAIL2){fillInputBoxValueToParentTd(k,j,h,i.reportfamily,parseInt(m))}}}function closePopUpPageEvent(d){if(WX_PARENT_INPUTBOXID&&WX_PARENT_INPUTBOXID!=""){var c=document.getElementById(WX_PARENT_INPUTBOXID);if(c){c.focus()}}WX_PARENT_INPUTBOXID=""}function isSelectedValueForSelectedBox(k,l,i){if(k==null||l==null){return false}var j=i.getAttribute("separator");if(j==null||j==""){return k==l}else{if(k==l){return true}if(j!=" "){k=wx_trim(k)}var h=k.split(j);for(var g=0;g<h.length;g++){if(h[g]==l){return true}}return false}}var WX_contextmenuObj=null;function showcontextmenu(m,n){if(WX_contextmenuObj!=null){WX_contextmenuObj.style.visibility="hidden"}WX_contextmenuObj=document.getElementById(m);if(WX_contextmenuObj==null){return}var l=WX_contextmenuObj.getAttribute("isEmpty");if(l=="true"){return}var p=n||window.event;var k=getDocumentSize();var e=k.width-p.clientX;var j=k.height-p.clientY;var o=getDocumentScroll();if(e<WX_contextmenuObj.offsetWidth){WX_contextmenuObj.style.left=(o.scrollLeft+p.clientX-WX_contextmenuObj.offsetWidth)+"px"}else{WX_contextmenuObj.style.left=(o.scrollLeft+p.clientX)+"px"}if(j<WX_contextmenuObj.offsetHeight){WX_contextmenuObj.style.top=(o.scrollTop+p.clientY-WX_contextmenuObj.offsetHeight)+"px"}else{WX_contextmenuObj.style.top=(o.scrollTop+p.clientY)+"px"}WX_contextmenuObj.style.visibility="visible";if(window.event){p.returnValue=false}else{p.preventDefault()}document.onclick=hidecontextmenu;return false}function hidecontextmenu(){WX_contextmenuObj.style.visibility="hidden"}function highlightmenuitem(e){var f=e||window.event;var d=f.srcElement||f.target;if(d.className=="contextmenuitems_enabled"){d.style.backgroundColor="highlight";d.style.color="white"}else{if(d.className=="contextmenuitems_disabled"){d.style.backgroundColor="highlight"}}}function lowlightmenuitem(e){var f=e||window.event;var d=f.srcElement||f.target;if(d.className=="contextmenuitems_enabled"){d.style.backgroundColor="";d.style.color="black"}else{if(d.className=="contextmenuitems_disabled"){d.style.backgroundColor=""}}}function forwardPageWithBack(g,h,k){h=paramdecode(h);var i=document.getElementById(g+"_url_id");var l=i.getAttribute("encodevalue");if(l==null||l==""){wx_error("没有取到本页面的URL，跳转失败");return}var j=i.getAttribute("ancestorPageUrls");if(j==null||j==""){j=l}else{j=l+"||"+j}h=replaceUrlParamValue(h,"ancestorPageUrls",j);h=replaceUrlParamValue(h,"refreshComponentGuid","[OUTERPAGE]"+g);h=replaceUrlParamValue(h,"SLAVE_REPORTID",null);if(k!=null&&k!=""){h=k(h)}if(h!=null&&h!=""){refreshComponent(h)}}function removeLazyLoadParamsFromUrl(i,l,n){i=replaceUrlParamValue(i,l.reportid+"_lazyload",null);i=replaceUrlParamValue(i,l.reportid+"_lazyloadmessage",null);if(n){var j=l.metaDataSpanObj.getAttribute("relateConditionReportIds");if(j!=null&&j!=""){var k=j.split(";");var m;for(var h=0;h<k.length;h=h+1){m=k[h];if(m==null||m==""){continue}i=replaceUrlParamValue(i,m+"_lazyload",null);i=replaceUrlParamValue(i,m+"_lazyloadmessage",null)}}}return i}function invokeServerActionForReportDataImpl(J,K,F,Q,i,I,z,T){var M=getComponentGuidById(J,K);var E=getReportMetadataObj(M);if(E==null){return}if(z==""){z=null}if(z!=null&&typeof z!="function"){wx_warn("传入的beforeCallbackMethod参数不是函数对象");return}if(T==""){T=null}if(T!=null&&typeof T!="function"){wx_warn("传入的afterCallbackMethod参数不是函数对象");return}var C=null;if(F.indexOf("button{")==0){C=Q}else{if(F.indexOf("button_autoreportdata{")==0){var G=F.indexOf("button_autoreportdata{");F=F.substring(0,G)+"button{"+F.substring(G+"button_autoreportdata{".length)}C=new Array();var L=convertToArray(getEditableReportColValues(J,K,null,Q));if(L!=null&&L.length>0){var O=null;var R=null;for(var D=0,A=L.length;D<A;D++){O=new Object();var B=false;for(var y in L[D]){R=L[D][y];if(R==null||R.name==null||R.name==""){continue}B=true;if(R.value==null){L[D].value=""}O[R.name]=R.value;if(R.oldname==null||R.oldname==""||R.oldname==R.name){continue}if(R.oldvalue==null){R.oldvalue=""}O[R.oldname]=R.oldvalue}if(B){C[C.length]=O}}}if(C.length==0){wx_warn("没有取到要操作的报表数据！");return}}if(z!=null){if(C==null){C=new Array()}if(i==null){i=new Object()}var N=z(C,i);if(N!==true){return}}var H=null;if(T!=null){H=M}var S=assempleServerActionDataParams(H,C);var P=getComponentUrl(E.pageid,E.refreshComponentGuid,E.slave_reportid);if(I){P=removeReportNavigateInfosFromUrl(P,E,null);P=P+"&WX_SERVERACTION_SHOULDREFRESH=true"}if(S!=null&&S!=""){P=P+"&WX_SERVERACTION_PARAMS="+S}S=getCustomizedParamsObjAsString(i);if(S!=null&&S!=""){P=P+"&WX_SERVERACTION_CUSTOMIZEDPARAMS="+S}if(T!=null){P=P+"&WX_SERVERACTION_CALLBACKMETHOD="+getFunctionNameByFunctionObj(T)}P=P+"&WX_SERVERACTION_COMPONENTID="+K;P=P+"&WX_SERVERACTION_SERVERCLASS="+F;refreshComponent(P)}function getCustomizedParamsObjAsString(f){if(f==null||f==""){return""}var d="";for(var e in f){if(f[e]==null||f[e]==""){continue}d+=e+SAVING_NAMEVALUE_SEPERATOR+encodeURIComponent(f[e])+SAVING_COLDATA_SEPERATOR}if(d.lastIndexOf(SAVING_COLDATA_SEPERATOR)==d.length-SAVING_COLDATA_SEPERATOR.length){d=d.substring(0,d.length-SAVING_COLDATA_SEPERATOR.length)}return d}function invokeServerActionForComponentImpl(t,n,s,p,u,q){if(q!=null&&typeof q!="function"){wx_warn("传入的回调函数不是函数对象");return}var l=getComponentGuidById(t,n);var r=getComponentMetadataObj(l);if(r==null){return}var v=getComponentUrl(t,r.refreshComponentGuid,r.metaDataSpanObj.getAttribute("slave_reportid"));if(v==null||v==""){return}if(u){v=resetComponentUrl(t,n,v,"navigate");v=v+"&WX_SERVERACTION_SHOULDREFRESH=true"}if(n==null||n==""){n=t}v=v+"&WX_SERVERACTION_COMPONENTID="+n;var o=null;if(q!=null){v=v+"&WX_SERVERACTION_CALLBACKMETHOD="+getFunctionNameByFunctionObj(q);o=l}var m=assempleServerActionDataParams(o,p);if(m!=null&&m!=""){v=v+"&WX_SERVERACTION_PARAMS="+m}v=v+"&WX_SERVERACTION_SERVERCLASS="+s;refreshComponent(v)}function getFunctionNameByFunctionObj(d){if(d==null||typeof d!="function"){return""}var f=wx_trim(d.toString());var e=f.indexOf("function");if(e<0){return""}f=f.substring(e+"function".length);f=f.substring(0,f.indexOf("("));return wx_trim(f)}function invokeServerActionImpl(l,j,p,m){if(p!=null&&typeof p!="function"){wx_warn("传入的回调函数不是函数对象");return}if(m!=null&&typeof m!="function"){wx_warn("传入的出错处理函数不是函数对象");return}var i=WXConfig.showreport_url;var o="?";if(i.indexOf("?")>0){o="&"}i=i+o+"ACTIONTYPE=invokeServerAction";var k=assempleServerActionDataParams(null,j);if(k!=null&&k!=""){i=i+"&WX_SERVERACTION_PARAMS="+k}i=i+"&WX_SERVERACTION_SERVERCLASS="+l;var n=i.substring(i.indexOf("?")+1);i=i.substring(0,i.indexOf("?"));XMLHttpREPORT.sendReq("POST",i,n,p,m,j)}function assempleServerActionDataParams(n,i){if(i==null||i==""){return""}var m=convertToArray(i);var l="";for(var o=0,j=m.length;o<j;o++){var k="";for(var p in m[o]){if(p==null||p==""){continue}if(m[o][p]==null){m[o][p]=""}k=k+p+SAVING_NAMEVALUE_SEPERATOR+encodeURIComponent(m[o][p])+SAVING_COLDATA_SEPERATOR}if(k.lastIndexOf(SAVING_COLDATA_SEPERATOR)==k.length-SAVING_COLDATA_SEPERATOR.length){k=k.substring(0,k.length-SAVING_COLDATA_SEPERATOR.length)}if(k==""){continue}l=l+k+SAVING_ROWDATA_SEPERATOR}if(l.lastIndexOf(SAVING_ROWDATA_SEPERATOR)==l.length-SAVING_ROWDATA_SEPERATOR.length){l=l.substring(0,l.length-SAVING_ROWDATA_SEPERATOR.length)}if(l==""){return""}if(n!=null&&n!=""){if(WX_ALL_SAVEING_DATA==null){WX_ALL_SAVEING_DATA=new Object()}WX_ALL_SAVEING_DATA[n]=m}return l}function fixedRowColTable(b){new fixedRowColTableObj(b)}var WX_M_FIXEDCOLSWIDTH;function fixedRowColTableObj(J){var U=J.pageid;var V=J.reportid;var Z=getComponentGuidById(U,V);var S=getReportMetadataObj(Z);var ad=S.metaDataSpanObj.getAttribute("ft_fixedRowsCount");var L=S.metaDataSpanObj.getAttribute("ft_fixedColids");var aa=S.metaDataSpanObj.getAttribute("ft_totalColCount");if((ad==null||ad=="")&&(L==null||L=="")){return}if(aa==null||aa==""){return}this.fixedRowsCount=parseInt(ad);if(L!=null&&L!=""){var H=new Array();var N=L.split(";");for(var i=0,Q=N.length;i<Q;i++){if(N[i]==null||N[i]==""){continue}H[H.length]=N[i]}this.fixedColidsArr=H;this.fixedColsCount=H.length}else{this.fixedColsCount=0;this.fixedColidsArr=null}this.colcnt=parseInt(aa);if(this.fixedRowsCount<0){this.fixedRowsCount=0}if(this.fixedColsCount<0){this.fixedColsCount=0}if(this.colcnt<=0){return}this.tableObj=document.getElementById(Z+"_data");var ac=this.tableObj.tBodies[0].rows;if(ac==null||ac.length<=0){return}if(this.fixedRowsCount>ac.length){this.fixedRowsCount=ac.length}this.divContainerObj=document.createElement("DIV");this.divFixedHeaderObj=this.divContainerObj.cloneNode(false);this.divHeaderObj=this.divContainerObj.cloneNode(false);this.divHeaderInnerObj=this.divContainerObj.cloneNode(false);this.divFixedDataObj=this.divContainerObj.cloneNode(false);this.divFixedDataInnerObj=this.divContainerObj.cloneNode(false);this.divDataObj=this.divContainerObj.cloneNode(false);this.colGroupObj=document.createElement("COLGROUP");this.tableObj.style.margin="0px";if(this.tableObj.getElementsByTagName("COLGROUP").length>0){this.tableObj.removeChild(this.tableObj.getElementsByTagName("COLGROUP")[0])}this.parentDivObj=this.tableObj.parentNode;this.tableParentDivHeight=this.parentDivObj.offsetHeight;this.tableParentDivWidth=this.parentDivObj.offsetWidth;if(this.parentDivObj.style.height==null||this.parentDivObj.style.height==""){this.parentDivObj.style.height=this.tableParentDivHeight+"px"}this.divContainerObj.className="cls-fixed-divcontainer";this.divFixedHeaderObj.className="cls-fixed-fixedHeader";this.divHeaderObj.className="cls-fixed-header";this.divHeaderInnerObj.className="cls-fixed-headerInner";this.divFixedDataObj.className="cls-fixed-fixeddata";this.divFixedDataInnerObj.className="cls-fixed-fixeddataInner";this.divDataObj.className="cls-fixed-data";this.divDataObj.id=Z+"_fixeddata";var ab,M;this.headerTableObj=this.tableObj.cloneNode(false);if(this.tableObj.tHead){ab=this.tableObj.tHead;this.headerTableObj.appendChild(ab.cloneNode(false));M=this.headerTableObj.tHead}else{ab=this.tableObj.tBodies[0];this.headerTableObj.appendChild(ab.cloneNode(false));M=this.headerTableObj.tBodies[0]}ab=ab.rows;for(var i=0;i<this.fixedRowsCount;i++){M.appendChild(ab[i].cloneNode(true))}this.divHeaderInnerObj.appendChild(this.headerTableObj);if(this.fixedColsCount>0){this.fixedHeaderTableObj=this.headerTableObj.cloneNode(true);this.divFixedHeaderObj.appendChild(this.fixedHeaderTableObj);this.sFDataTable=this.tableObj.cloneNode(true);this.divFixedDataInnerObj.appendChild(this.sFDataTable)}var R=getValidRowidx(ac,this.colcnt);var j=0;for(var i=0,Q=R.cells.length;i<Q;i++){var X=R.cells[i].colSpan;var P=R.cells[i].style.display=="none";var G=R.cells[i].offsetWidth;if(X>1){if(!P){G=G/X}}else{X=1}for(var F=0;F<X;F++){var I=document.createElement("COL");if(P){if(!isIE){this.colGroupObj.appendChild(I);this.colGroupObj.lastChild.style.display="none"}}else{this.colGroupObj.appendChild(I);if(j<this.fixedColsCount){if(WX_M_FIXEDCOLSWIDTH==null){WX_M_FIXEDCOLSWIDTH=new Object()}var T=WX_M_FIXEDCOLSWIDTH[Z+this.fixedColidsArr[j]];if(T==null||T==""){WX_M_FIXEDCOLSWIDTH[Z+this.fixedColidsArr[j]]=G;T=G}this.colGroupObj.lastChild.setAttribute("width",T)}else{this.colGroupObj.lastChild.setAttribute("width",G)}j++}}}this.tableObj.insertBefore(this.colGroupObj.cloneNode(true),this.tableObj.firstChild);this.headerTableObj.insertBefore(this.colGroupObj.cloneNode(true),this.headerTableObj.firstChild);if(this.fixedColsCount>0){this.sFDataTable.insertBefore(this.colGroupObj.cloneNode(true),this.sFDataTable.firstChild);this.fixedHeaderTableObj.insertBefore(this.colGroupObj.cloneNode(true),this.fixedHeaderTableObj.firstChild)}if(this.fixedColsCount>0){this.sFDataTable.className+=" cls-fixed-cols"}if(this.fixedColsCount>0){this.divContainerObj.appendChild(this.divFixedHeaderObj)}this.divHeaderObj.appendChild(this.divHeaderInnerObj);this.divContainerObj.appendChild(this.divHeaderObj);if(this.fixedColsCount>0){this.divFixedDataObj.appendChild(this.divFixedDataInnerObj);this.divContainerObj.appendChild(this.divFixedDataObj)}this.divContainerObj.appendChild(this.divDataObj);this.parentDivObj.insertBefore(this.divContainerObj,this.tableObj);this.divDataObj.appendChild(this.tableObj);var O,K;this.sHeaderHeight=this.tableObj.tBodies[0].rows[(this.tableObj.tHead)?0:this.fixedRowsCount].offsetTop;K="margin-top: "+(this.sHeaderHeight*-1)+"px;";O="margin-top: "+this.sHeaderHeight+"px;";O+="height: "+(this.tableParentDivHeight-this.sHeaderHeight)+"px;";if(this.fixedColsCount>0){var Y=null;for(var i=0,Q=ac.length;i<Q;i++){for(var k=0,W=ac[i].cells.length;k<W;k++){if(ac[i].cells[k].getAttribute("first_nonfixed_col")=="true"){Y=ac[i].cells[k];break}}if(Y!=null){break}}this.sFHeaderWidth=-1;if(Y!=null){this.sFHeaderWidth=Y.offsetLeft}if(window.getComputedStyle){ab=document.defaultView;M=this.tableObj.tBodies[0].rows[0].cells[0];if(navigator.taintEnabled){this.sFHeaderWidth+=Math.ceil(parseInt(ab.getComputedStyle(M,null).getPropertyValue("border-right-width"))/2)}else{this.sFHeaderWidth+=parseInt(ab.getComputedStyle(M,null).getPropertyValue("border-right-width"))}}else{if(isIE){ab=this.tableObj.tBodies[0].rows[0].cells[0];M=[ab.currentStyle.borderRightWidth,ab.currentStyle.borderLeftWidth];if(/px/i.test(M[0])&&/px/i.test(M[1])){M=[parseInt(M[0]),parseInt(M[1])].sort();this.sFHeaderWidth+=Math.ceil(parseInt(M[1])/2)}}}if(window.opera){this.divFixedDataObj.style.height=this.tableParentDivHeight+"px"}if(this.sFHeaderWidth>=0){this.divFixedHeaderObj.style.width=this.sFHeaderWidth+"px";K+="margin-left: "+(this.sFHeaderWidth*-1)+"px;";O+="margin-left: "+this.sFHeaderWidth+"px;";O+="width: "+(this.tableParentDivWidth-this.sFHeaderWidth)+"px;"}}else{O+="width: "+this.tableParentDivWidth+"px;"}this.divDataObj.style.cssText=O;this.tableObj.style.cssText=K;(function(a){if(a.fixedColsCount>0){a.divDataObj.onscroll=function(){a.divHeaderInnerObj.style.right=a.divDataObj.scrollLeft+"px";a.divFixedDataInnerObj.style.top=(a.divDataObj.scrollTop*-1)+"px"}}else{a.divDataObj.onscroll=function(){a.divHeaderInnerObj.style.right=a.divDataObj.scrollLeft+"px"}}if(isIE){window.attachEvent("onunload",function(){a.divDataObj.onscroll=null;a=null})}})(this)}function getValidRowidx(n,r){var t=-1;var m;for(var o=0,j=n.length;o<j;o++){m=n[o];if(t<0||m.cells.length>n[t].cells.length){t=o}var i=1;var s=false;for(var p=0,q=m.cells.length;p<q;p++){if(m.cells[p].rowSpan>i){i=m.cells[p].rowSpan}if(s){continue}if(m.cells[p].colSpan>1){s=true}}if(!s&&r==m.cells.length){return m}o+=i-1}return n[t]}function getParentFixedDataObj(c,d){while(true){if(d==null){return null}if(d.getAttribute("id")=="WX_CONTENT_"+c){return null}if(d.className=="cls-fixed-divcontainer"){return document.getElementById(c+"_fixeddata")}d=d.parentNode}}function shiftTabPanelItemAsyn(h,l,j,i,k){var g=getComponentUrl(h,j,null);g=replaceUrlParamValue(g,l+"_selectedIndex",i);if(k!=null&&k!=""){g=k(h,l,g);if(g==null||g==""){return}}refreshComponent(g)}function shiftTabPanelItemSyn(z,A,v,w){var E=getComponentGuidById(z,A);var y=document.getElementById(E+"_"+w+"_title");var x=getParentElementObj(y,"TABLE");var t=x.getAttribute("selectedItemIndex");if(t==null||t==""){t="0"}if(w==t){return}var u=document.getElementById(E+"_"+t+"_content");u.style.display="none";var F=document.getElementById(E+"_"+w+"_content");F.style.display="";var s=document.getElementById(E+"_"+t+"_title");var y=document.getElementById(E+"_"+w+"_title");var B=s.className;s.className=y.className;y.className=B;var r=y.getAttribute("tabitem_position_type");var q=s.getAttribute("tabitem_position_type");if(r=="first"||r=="middle"||r=="last"){changeImgForTabItemTitle(E,w,t,r,q)}x.setAttribute("selectedItemIndex",w);var C=getComponentUrl(z,v,null);C=replaceUrlParamValue(C,A+"_selectedIndex",w);var D=document.getElementById(z+"_url_id");D.setAttribute("value",C)}function changeImgForTabItemTitle(z,t,u,o,n){var q=document;var w=q.getElementById(z+"_"+u+"_rightimg");var s=q.getElementById(z+"_"+t+"_rightimg");var p=w.src;var r=p.lastIndexOf("/");var v=p.substring(0,r)+"/";var x=parseInt(t,10);var y=parseInt(u,10);if(x-y==1){w.src=v+"title2_deselected_selected.gif";if(n!="first"){q.getElementById(z+"_"+(y-1)+"_rightimg").src=v+"title2_deselected_deselected.gif"}if(o=="last"){s.src=v+"title2_selected.gif"}else{s.src=v+"title2_selected_deselected.gif"}}else{if(y-x==1){s.src=v+"title2_selected_deselected.gif";if(o!="first"){q.getElementById(z+"_"+(x-1)+"_rightimg").src=v+"title2_deselected_selected.gif"}if(n=="last"){w.src=v+"title2_deselected.gif"}else{w.src=v+"title2_deselected_deselected.gif"}}else{if(n=="first"){w.src=v+"title2_deselected_deselected.gif"}else{if(n=="middle"){w.src=v+"title2_deselected_deselected.gif";q.getElementById(z+"_"+(y-1)+"_rightimg").src=v+"title2_deselected_deselected.gif"}else{if(n=="last"){w.src=v+"title2_deselected.gif";q.getElementById(z+"_"+(y-1)+"_rightimg").src=v+"title2_deselected_deselected.gif"}}}if(o=="first"){s.src=v+"title2_selected_deselected.gif"}else{if(o=="middle"){s.src=v+"title2_selected_deselected.gif";q.getElementById(z+"_"+(x-1)+"_rightimg").src=v+"title2_deselected_selected.gif"}else{if(o=="last"){s.src=v+"title2_selected.gif";q.getElementById(z+"_"+(x-1)+"_rightimg").src=v+"title2_deselected_selected.gif"}}}}}}function adjustTabItemTitleImgHeight(g){if(g==null||g.tabpanelguid==null||g.tabpanelguid==""||g.tabitemcount==null){return}var h=document;var e;for(var f=0;f<g.tabitemcount;f++){e=h.getElementById(g.tabpanelguid+"_"+f+"_rightimg");if(e!=null){e.style.height=e.parentNode.clientHeight+"px"}}}var LODOP_OBJ;function printComponentsData(y,s,r,w){if(r==null||r==""){return}var u=parseStringToArray(r,";",false);if(u==null||u.length==0){return}var z="";if(u.length==1){var i=getComponentGuidById(y,u[0]);var p=getReportMetadataObj(i);if(p==null){z=getComponentUrl(y,null,null)}else{z=getComponentUrl(y,p.refreshComponentGuid,p.slave_reportid)}}else{z=getComponentUrl(y,null,null);var q=null;for(var v=0,t=u.length;v<t;v++){q=getReportMetadataObj(getComponentGuidById(y,u[v]));if(q==null){continue}if(q.slave_reportid==u[v]){var A=getComponentUrl(y,null,u[v]);z=mergeUrlParams(z,A,false);z=replaceUrlParamValue(z,"SLAVE_REPORTID",null)}}}z=replaceUrlParamValue(z,"COMPONENTIDS",s);z=replaceUrlParamValue(z,"INCLUDE_APPLICATIONIDS",r);z=replaceUrlParamValue(z,"DISPLAY_TYPE","6");z=replaceUrlParamValue(z,"WX_ISAJAXLOAD","true");var x=z.substring(z.indexOf("?")+1);z=z.substring(0,z.indexOf("?"));var B=new Object();B.pageid=y;B.printtype=w;XMLHttpREPORT.sendReq("POST",z,x,printCallBack,onPrintErrorMethod,B)}function printCallBack(l,v){var o=l.responseText;var u=v.pageid;var s=v.printtype;var q=o.indexOf("<RESULTS_INFO-"+u+">");var r=o.indexOf("</RESULTS_INFO-"+u+">");var n=null;if(q>=0&&r>=0&&r>q){n=o.substring(q+("<RESULTS_INFO-"+u+">").length,r);o=o.substring(0,q)+o.substring(r+("</RESULTS_INFO-"+u+">").length)}var p=getObjectByJsonString(n);var m=p.onloadMethods;if(m&&m!=""){var t="";q=o.indexOf("<print-jobname-"+u+">");r=o.indexOf("</print-jobname-"+u+">");if(q>=0&&r>q){t=o.substring(q+("<print-jobname-"+u+">").length,r);o=o.substring(0,q)+o.substring(r+("</print-jobname-"+u+">").length)}m[0].methodname(t,o,s)}}function onPrintErrorMethod(b){wx_error("打印失败")}function getAdvancedPrintRealValue(f,h){if(f==null||f==""||h==null||h==""){return""}var i="<"+h+">";var j="</"+h+">";var g=f.indexOf(i);if(g<0){return""}f=f.substring(g+i.length);g=f.indexOf(j);if(g<0){return f}return f.substring(0,g)}function getAdvancedPrintRealValueForPage(g,i,j){if(g==null||g==""||i==null||i==""){return""}var k="<"+i+">";var l="</"+i+">";var h=g.indexOf(k);if(h<0){return""}g=g.substring(h+k.length);h=g.indexOf(l);if(h>=0){g=g.substring(0,h)}if(j==null||j==""){return g}k="<"+j+">";l="</"+j+">";h=g.indexOf(k);if(h<0){return""}g=g.substring(h+k.length);h=g.indexOf(l);if(h<0){return g}return g.substring(0,h)}function getPrintPageCount(f,h){if(f==null||f==""||h==null||h==""){return 0}var i="<"+h+"_pagecount>";var j="</"+h+"_pagecount>";var g=f.indexOf(i);if(g<0){return 0}f=f.substring(g+i.length);g=f.indexOf(j);if(g<0){return 0}return parseInt(f.substring(0,g),10)}function wx_sendRedirect(b){if(b==null||b.url==null||b.url==""){return}window.location.href=b.url}var WX_ISSYSTEM_LOADED=true;